agenda_screen As screen:
    Fill: =RGBA(45, 45, 45, 1)
    OnVisible: |
        =//PAGE DEFAULTS
        Set(isAgendaEdit, false);
        Set(isAgendaVisible, true);
        
        //END
        
        Set(_dateSelected, Today());
        Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));
        Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
        Set(_calendarVisible, true);
        
        Set(_myCalendar, LookUp(
                Office365Outlook.CalendarGetTables().value, 
                DisplayName = "Agenda"
            ));
        
        // Ensure the _userDomain is set; if not already set
        If(IsBlank(_userDomain), 
            UpdateContext({_showLoading: true}),
            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
            Set(_dateSelected, Today()),
            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
        );
        
        // Set the calendar visibility and show loading context
        Set(_calendarVisible, false);
        UpdateContext({_showLoading: true});
        
        // Set the calendar variable based on the chosen Agenda
        
        
        // Calculate min and max dates for the calendar view
        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
        
        // Retrieve calendar events and store them in a collection
        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
        
        // Hide loading context and make the calendar visible
        UpdateContext({_showLoading: false});
        Set(_calendarVisible, true);

    container_41 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =131
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =625
        X: =675
        Y: =40
        ZIndex: =11

        Button1 As button:
            OnSelect: |-
                =Office365Outlook.V4CalendarPostItem(
                LookUp(
                        Office365Outlook.CalendarGetTables().value, 
                        DisplayName = "Agenda"
                    ).Name, 
                        "TEST",
                        Text(DatePicker1.SelectedDate, "yyyy-mm-dd") & "T00:00:00.000Z",
                        Text(DateAdd(DatePicker1.SelectedDate, 1, TimeUnit.Days), "yyyy-mm-dd") & "T00:00:00.000Z",
                
                        "UTC",
                        {
                            //requiredAttendees: Concat(InviteesNew.SelectedItems.Email; Email; ";");
                            requiredAttendees: "jools.l.reinartz@gmail.com",
                            responseRequested: false,
                            isAllDay: false
                        }
                    )
            Text: ="Knop"
            X: =330
            Y: =67
            ZIndex: =1

        DatePicker1 As datepicker:
            Height: =36
            Width: =161
            X: =39
            Y: =69
            ZIndex: =2

        Label6 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =48
            Size: =16
            Text: ="Meeting Inplannen"
            Width: =625
            Y: =9
            ZIndex: =3

    container_42 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =131
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =450
        X: =180
        Y: =40
        ZIndex: =12

        LblMonthSelected1_2 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =48
            Size: =16
            Text: ="Het is vandaag"
            Visible: |
                =isAgendaVisible && !isAgendaEdit
            Width: =387
            Wrap: =false
            X: =21
            Y: =21
            ZIndex: =1

        LblMonthSelected1_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =48
            Size: =32
            Text: ="XX-XX-XXXX"
            Visible: |
                =isAgendaVisible && !isAgendaEdit
            Width: =387
            Wrap: =false
            X: =21
            Y: =57
            ZIndex: =2

    container_43 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =522
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =1120
        X: =180
        Y: =203
        ZIndex: =13

        CloseCalendarButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: =Set(isAgendaVisible, false)
            Rotation: =
            Visible: =isAgendaVisible && !isAgendaEdit
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =12

        CloseCalendarEditButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: =Set(isAgendaVisible, true)
            Rotation: =If(isAgendaEdit || !isAgendaVisible = true, "45", "0")
            Visible: =!isAgendaVisible
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =13

        Group20 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =13

            CalendarEventsGallery1_1 As gallery.CalendarEventsGallery:
                AccessibleLabel: ="Agenda-items voor geselecteerde dag"
                Height: =Parent.Height - Self.Y
                Items: =SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =109
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =543
                X: =576
                Y: =LblDateSelected1.Y + LblDateSelected1.Height
                ZIndex: =8

                Icon16 As icon.Edit:
                    Color: =RGBA(128, 128, 128, 1)
                    Height: =27
                    Icon: =Icon.OpenInNewWindow
                    OnSelect: |
                        =Set(isAgendaEdit, true);
                        Set(currentCalendarEventEmails, CalendarEventsGallery1_1.Selected.RequiredAttendees)
                    Width: =27
                    X: =466
                    Y: =60
                    ZIndex: =6

                Icon17 As icon.Trash:
                    Color: =RGBA(168, 0, 0, 1)
                    Height: =27
                    Icon: =Icon.Trash
                    OnSelect: |-
                        =
                            Office365Outlook.CalendarDeleteItemV2(_myCalendar.Name, ThisItem.Id);
                            RemoveIf(MyCalendarEvents, Id = ThisItem.Id);
                        
                        
                        
                        // Ensure the _userDomain is set; if not already set
                        If(IsBlank(_userDomain), 
                            UpdateContext({_showLoading: true}),
                            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
                            Set(_dateSelected, Today()),
                            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
                            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
                            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
                        );
                        
                        // Set the calendar visibility and show loading context
                        Set(_calendarVisible, false);
                        UpdateContext({_showLoading: true});
                        
                        // Set the calendar variable based on the chosen Agenda
                        
                        
                        // Calculate min and max dates for the calendar view
                        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
                        
                        // Retrieve calendar events and store them in a collection
                        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
                        
                        // Hide loading context and make the calendar visible
                        UpdateContext({_showLoading: false});
                        Set(_calendarVisible, true);
                    Width: =27
                    X: =506
                    Y: =60
                    ZIndex: =7

            LblDateSelected1_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =RectMeetingBkg1.Height
                Size: =26
                Text: |
                    =Upper(Left(Text(_dateSelected, "dddd"), 1)) & Lower(Mid(Text(_dateSelected, "dddd"), 2))
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =Parent.Width / 3 - 60
                Wrap: =false
                X: =576
                Y: =21
                ZIndex: =9

            LblDateSelected1_2 As label:
                Color: =RGBA(207, 207, 207, 1)
                FontWeight: =FontWeight.Lighter
                Height: =RectMeetingBkg1.Height
                Size: =13
                Text: |-
                    =
                    Text(_dateSelected, DateTimeFormat.ShortDate)
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =Parent.Width / 3 - 60
                Wrap: =false
                X: =576
                Y: =53
                ZIndex: =10

            Rectangle4 As rectangle:
                Fill: =RGBA(192, 5, 230, 1)
                Height: =400
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =1
                X: =560
                Y: =61
                ZIndex: =11

        CloseCalendarCancelEditButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: =Set(isAgendaEdit, false)
            Rotation: =45
            Visible: =isAgendaEdit
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =14

        Label9 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =76
            Text: ="Er zijn geen meetings gepland op deze dag."
            Visible: |-
                =If(IsEmpty(
                
                
                SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
                
                ), true,false)
            Width: =544
            X: =576
            Y: =251
            ZIndex: =20

        Group22 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =20

            Label8 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Bold
                Height: =45
                PaddingLeft: =0
                Size: =26
                Text: =CalendarEventsGallery1_1.Selected.Subject
                Visible: =isAgendaEdit
                Width: =884
                X: =15
                Y: =29
                ZIndex: =15

            Label8_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Upper(Left(Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.LongDate), 1)) &
                    Mid(Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.LongDate), 2)
                Visible: =isAgendaEdit
                Width: =486
                X: =15
                Y: =64
                ZIndex: =16

            Label8_2 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |-
                    ="Uitgenodigd:"
                Visible: =isAgendaEdit
                Width: =486
                X: =15
                Y: =184
                ZIndex: =17

            Label8_3 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =246
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Concat(
                        Split(currentCalendarEventEmails, ";"),
                        Value & Char(10)
                    )
                VerticalAlign: =VerticalAlign.Top
                Visible: =isAgendaEdit
                Width: =508
                X: =15
                Y: =215
                ZIndex: =18

            Label8_4 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.ShortTime) & " - " & Text(CalendarEventsGallery1_1.Selected.End, DateTimeFormat.ShortTime)
                Visible: =isAgendaEdit
                Width: =486
                X: =15
                Y: =93
                ZIndex: =19

        CloseCalendarCancelEditButton_1 As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Edit
            OnSelect: =Set(isEventEditing, true)
            Visible: =isAgendaEdit
            Width: =36
            X: =1020
            Y: =21
            ZIndex: =21

    navigatie_component_9 As navigatie_component:
        nav_cursussenScreen: =courses_screen_1
        nav_groepenScreen: =groups_screen
        nav_intakesScreen: =intakes_screen
        nav_presenterenScreen: =presentatie_screen
        nav_studentenScreen: =students_screen
        ZIndex: =15

