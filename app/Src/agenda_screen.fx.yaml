agenda_screen As screen:
    Fill: =RGBA(45, 45, 45, 1)
    OnVisible: |
        =Set(_dateSelected, Today());
        Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));
        Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
        Set(_calendarVisible, true);
        
        Set(_myCalendar, LookUp(
                Office365Outlook.CalendarGetTables().value, 
                DisplayName = "Agenda"
            ));
        
        // Ensure the _userDomain is set; if not already set
        If(IsBlank(_userDomain), 
            UpdateContext({_showLoading: true}),
            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
            Set(_dateSelected, Today()),
            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
        );
        
        // Set the calendar visibility and show loading context
        Set(_calendarVisible, false);
        UpdateContext({_showLoading: true});
        
        // Set the calendar variable based on the chosen Agenda
        
        
        // Calculate min and max dates for the calendar view
        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
        
        // Retrieve calendar events and store them in a collection
        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
        
        // Hide loading context and make the calendar visible
        UpdateContext({_showLoading: false});
        Set(_calendarVisible, true);

    container_41 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =131
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =625
        X: =180
        Y: =40
        ZIndex: =11

        Button1 As button:
            OnSelect: |-
                =Office365Outlook.V4CalendarPostItem(
                LookUp(
                        Office365Outlook.CalendarGetTables().value, 
                        DisplayName = "Agenda"
                    ).Name, 
                        "TEST",
                        Text(DatePicker1.SelectedDate, "yyyy-mm-dd") & "T00:00:00.000Z",
                        Text(DateAdd(DatePicker1.SelectedDate, 1, TimeUnit.Days), "yyyy-mm-dd") & "T00:00:00.000Z",
                
                        "UTC",
                        {
                            //requiredAttendees: Concat(InviteesNew.SelectedItems.Email; Email; ";");
                            requiredAttendees: "jools.l.reniartz@gmail.com",
                            responseRequested: false,
                            isAllDay: true
                        }
                    )
            Text: ="Knop"
            X: =330
            Y: =67
            ZIndex: =1

        DatePicker1 As datepicker:
            Height: =36
            Width: =161
            X: =39
            Y: =69
            ZIndex: =2

        Label6 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =48
            Size: =16
            Text: ="Meeting Inplannen"
            Width: =625
            Y: =9
            ZIndex: =3

    container_42 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =131
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =450
        X: =850
        Y: =40
        ZIndex: =12

    container_43 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =522
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =1120
        X: =180
        Y: =203
        ZIndex: =13

        Group13_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =7

            LblMonthSelected1_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =48
                Size: =32
                Text: =Text(_firstDayOfMonth, "mmmm yyyy")
                Visible: =_calendarVisible
                Width: =372
                Wrap: =false
                X: =14
                Y: =21
                ZIndex: =2

            iconPrevMonth1_1 As icon.ChevronLeft:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(192, 5, 230, 1)
                Height: =35
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =/*changes month view to previous month*/
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                    /*collects calendar events for all days in current month view. Updates _minDate to prevent duplicate data collection if user returns to this month view*/
                    If(_minDate > _firstDayOfMonth, Set(_minDate, _firstDayOfMonth); Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_lastDayOfMonth, DateTimeFormat.UTC)).value))
                PaddingBottom: =7
                PaddingLeft: =7
                PaddingRight: =7
                PaddingTop: =7
                TabIndex: =0
                Tooltip: ="Vorige maand weergeven"
                Visible: =_calendarVisible
                Width: =35
                X: =423
                Y: =28
                ZIndex: =3

            iconNextMonth1_1 As icon.ChevronRight:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(192, 5, 230, 1)
                Height: =35
                Icon: =Icon.ChevronRight
                OnSelect: |-
                    =/*changes month view to next month*/
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                    /*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                    If(_lastDayOfMonth > _maxDate, Set(_maxDate, _lastDayOfMonth); Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_firstDayOfMonth, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value))
                PaddingBottom: =7
                PaddingLeft: =7
                PaddingRight: =7
                PaddingTop: =7
                TabIndex: =0
                Tooltip: ="Volgende maand weergeven"
                Visible: =_calendarVisible
                Width: =35
                X: =470
                Y: =27
                ZIndex: =4

            WeekdayGallery1_1 As gallery.WeekdayGallery:
                AccessibleLabel: ="Dagen van de week"
                Height: =43
                Items: =Calendar.WeekdaysShort()
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =75
                Visible: =_calendarVisible
                Width: =528
                Y: =93
                ZIndex: =5

                Title2_1 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =WeekdayGallery1_1.TemplateHeight
                    OnSelect: =Select(Parent)
                    Size: =16
                    Text: =ThisItem.Value
                    Width: =WeekdayGallery1_1.TemplateWidth
                    Wrap: =false
                    X: =WeekdayGallery1_1.TemplateWidth / 2 - Self.Width / 2
                    Y: =WeekdayGallery1_1.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =1

            MonthDayGallery1_1 As gallery.MonthDayGallery:
                AccessibleLabel: ="Dagen van geselecteerde maand"
                Height: =368
                Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =60
                Visible: =_calendarVisible
                Width: =528
                WrapCount: =7
                Y: =136
                ZIndex: =6

                Circle2_1 As circle:
                    Fill: =RGBA(192, 5, 230, 1)
                    Height: =Self.Width
                    OnSelect: =Select(Parent)
                    Visible: |-
                        =/*Visible if calendar events are found on this day*/               
                        CountRows(Filter(MyCalendarEvents, DateValue(Text(Start)) = DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))) > 0 && !Subcircle1_1.Visible && Title3_2.Visible
                    Width: =6.5
                    X: =MonthDayGallery1_1.TemplateWidth / 2 - Self.Width / 2
                    Y: =MonthDayGallery1_1.TemplateHeight * (0.75)
                    ZIndex: =1

                Subcircle1_1 As circle:
                    Fill: =RGBA(192, 5, 230, 1)
                    Height: =3 * Title3_2.Size
                    OnSelect: =Select(Parent)
                    Visible: =And(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, Title3_2.Visible)
                    Width: =Self.Height
                    X: =MonthDayGallery1_1.TemplateWidth/2 - Self.Width/2
                    Y: =MonthDayGallery1_1.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =2

                Title3_2 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =
                    Color: =If(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(255, 255, 255, 1), DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(255, 255, 255, 1), LblMonthSelected1_1.Color)
                    Fill: |-
                        =        If(
                            /*Date selected is today*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0.1),
                            /*Today when it is not selected*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(0,0,0,0.1), 
                            /*The day is outside the range of the currently selected month*/
                            Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.1), RGBA(0, 0, 0, 0))
                    FocusedBorderColor: =Self.Color
                    FocusedBorderThickness: =2
                    Height: =MonthDayGallery1_1.TemplateHeight
                    OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                    Size: =17 * MonthDayGallery1_1.TemplateWidth / 91
                    TabIndex: =0
                    Text: =Day(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))
                    Visible: |-
                        =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                         !(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days)) + 1 > _lastDayOfMonth)
                    Width: =MonthDayGallery1_1.TemplateWidth
                    Wrap: =false
                    ZIndex: =3

        CalendarEventsGallery1_1 As gallery.CalendarEventsGallery:
            AccessibleLabel: ="Agenda-items voor geselecteerde dag"
            Height: =Parent.Height - Self.Y
            Items: |-
                =/*Shows events only on selected date*/
                SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
            Layout: =Layout.Vertical
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =85
            Visible: =_calendarVisible
            Width: =592
            X: =528
            Y: =LblDateSelected1.Y + LblDateSelected1.Height
            ZIndex: =8

            Rectangle3_1 As rectangle:
                BorderThickness: =If(ThisItem.Id = _selectedCalendarEvent.Id, 2, 0)
                Fill: =RGBA(0,0,0,0)
                Height: =85
                HoverFill: =RGBA(0,0,0,0)
                OnSelect: =Select(Title4_1)
                TabIndex: =0
                Width: =Parent.TemplateWidth
                ZIndex: =1

            Title4_1 As label:
                BorderColor: =Self.Color
                FocusedBorderThickness: =2
                FontWeight: =FontWeight.Semibold
                Height: =Self.Size * 1.8
                OnSelect: =Set(_selectedCalendarEvent, ThisItem)
                Size: =19 * CalendarEventsGallery1_1.TemplateHeight / 105
                TabIndex: =0
                Text: =ThisItem.Subject
                Tooltip: =ThisItem.Subject
                Width: =CalendarEventsGallery1_1.TemplateWidth - Self.X - 10
                Wrap: =false
                X: =18
                Y: =CalendarEventsGallery1_1.TemplateHeight / 4 - Self.Height / 2 + 5
                ZIndex: =3

            Subtitle2_1 As label:
                FocusedBorderThickness: =2
                FontWeight: =FontWeight.Lighter
                Height: =Self.Size * 2
                OnSelect: =Select(Title4_1)
                PaddingBottom: =0
                Size: =18 * CalendarEventsGallery1_1.TemplateHeight / 105
                Text: =ThisItem.Location
                Tooltip: =ThisItem.Location
                Width: =CalendarEventsGallery1_1.TemplateWidth - Self.X - 10
                Wrap: =false
                X: =18
                Y: =39
                ZIndex: =4

            Body1_1 As label:
                FocusedBorderThickness: =2
                Height: =Title4_1.Height
                OnSelect: =Select(Title4_1)
                Size: =17 * CalendarEventsGallery1_1.TemplateHeight / 105
                Text: =Text(ThisItem.Start, DateTimeFormat.ShortTime)
                Width: =110
                Wrap: =false
                X: =387
                Y: =24
                ZIndex: =5

            Description1_1 As label:
                FocusedBorderThickness: =2
                Height: =Subtitle2_1.Height
                OnSelect: =Select(Title4_1)
                Size: =17 * CalendarEventsGallery1_1.TemplateHeight / 105
                Text: =DateDiff(ThisItem.Start, ThisItem.End, TimeUnit.Minutes) & Lower(Left("Minute_Name", 1))
                Width: =100
                Wrap: =false
                X: =387
                Y: =56
                ZIndex: =6

            Separator1_1 As rectangle:
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =7

        LblDateSelected1_1 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =RectMeetingBkg1.Height
            Size: =26
            Text: |
                =Upper(Left(Text(_dateSelected, "dddd"), 1)) & Lower(Mid(Text(_dateSelected, "dddd"), 2))
            Visible: =_calendarVisible
            Width: =Parent.Width / 3 - 60
            Wrap: =false
            X: =560
            Y: =23
            ZIndex: =9

        LblDateSelected1_2 As label:
            Color: =RGBA(207, 207, 207, 1)
            FontWeight: =FontWeight.Lighter
            Height: =RectMeetingBkg1.Height
            Size: =13
            Text: |-
                =
                Text(_dateSelected, DateTimeFormat.ShortDate)
            Visible: =_calendarVisible
            Width: =Parent.Width / 3 - 60
            Wrap: =false
            X: =560
            Y: =51
            ZIndex: =10

    navigatie_component_9 As navigatie_component:
        nav_cursussenScreen: =courses_screen_1
        nav_groepenScreen: =groups_screen
        nav_intakesScreen: =intakes_screen
        nav_presenterenScreen: =presentatie_screen
        nav_studentenScreen: =students_screen
        ZIndex: =15

