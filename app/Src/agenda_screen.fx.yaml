agenda_screen As screen:
    Fill: =RGBA(45, 45, 45, 1)
    OnVisible: |
        =//PAGE DEFAULTS
        Set(isAgendaEdit, false);
        Set(popupNewMeeting, false);
        Set(isAgendaVisible, true);
        Set(dayName, Text(Today(), "dddd"));
        Clear(attendeesEmails);
        
        //END
        
        Set(_dateSelected, Today());
        Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days));
        Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
        Set(_calendarVisible, true);
        
        Set(_myCalendar, LookUp(
                Office365Outlook.CalendarGetTables().value, 
                DisplayName = "Agenda"
            ));
        
        // Ensure the _userDomain is set; if not already set
        If(IsBlank(_userDomain), 
            UpdateContext({_showLoading: true}),
            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
            Set(_dateSelected, Today()),
            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
        );
        
        // Set the calendar visibility and show loading context
        Set(_calendarVisible, false);
        UpdateContext({_showLoading: true});
        
        // Set the calendar variable based on the chosen Agenda
        
        
        // Calculate min and max dates for the calendar view
        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
        
        // Retrieve calendar events and store them in a collection
        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
        
        // Hide loading context and make the calendar visible
        UpdateContext({_showLoading: false});
        Set(_calendarVisible, true);

    navigatie_component_9 As navigatie_component:
        nav_agendaScreen: =agenda_screen
        nav_cursussenScreen: =courses_screen_1
        nav_groepenScreen: =groups_screen
        nav_intakesScreen: =intakes_screen
        nav_presenterenScreen: =presentatie_screen
        nav_studentenScreen: =students_screen

    container_42 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =131
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =450
        X: =180
        Y: =40
        ZIndex: =3

        LblMonthSelected1_2 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =48
            Size: =16
            Text: ="Het is vandaag"
            Visible: |-
                =
                true
            Width: =387
            Wrap: =false
            X: =21
            Y: =12
            ZIndex: =1

        LblMonthSelected1_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =70
            Size: =32
            Text: |-
                =If(
                    Or(
                        dayName = "monday",
                        dayName = "tuesday",
                        dayName = "wednesday",
                        dayName = "thursday",
                        dayName = "friday",
                        dayName = "saturday",
                        dayName = "sunday"
                    ),
                    
                    Switch(
                        dayName,
                        "monday", "Maandag",
                        "tuesday", "Dinsdag",
                        "wednesday", "Woensdag",
                        "thursday", "Donderdag",
                        "friday", "Vrijdag",
                        "saturday", "Zaterdag",
                        "sunday", "Zondag"
                    ),
                    
                    Switch(
                        dayName,
                        "maandag", "Maandag",
                        "dinsdag", "Dinsdag",
                        "woensdag", "Woensdag",
                        "donderdag", "Donderdag",
                        "vrijdag", "Vrijdag",
                        "zaterdag", "Zaterdag",
                        "zondag", "Zondag"
                    )
                )
                
                
                //Concatenate(
                //    Upper(Mid(dayName; 1; 1));
                //    Lower(Mid(dayName; 2; Len(dayName) - 1))
                //)
            Visible: |-
                =
                true
            Width: =418
            Wrap: =false
            X: =21
            Y: =34
            ZIndex: =2

        LblMonthSelected1_4 As label:
            Color: =RGBA(202, 202, 202, 1)
            FontWeight: =FontWeight.Lighter
            Height: =29
            Size: =13
            Text: =Text(Today(),"dd-mm")
            Visible: |-
                =
                true
            Width: =387
            Wrap: =false
            X: =21
            Y: =89
            ZIndex: =3

    container_43 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =522
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =1120
        X: =180
        Y: =203
        ZIndex: =4

        CloseCalendarButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: |-
                =//Set(isAgendaVisible; false)
                Set(popupNewMeeting, true);
                Set(dropdownEmailsCollection, "intakes")
            Rotation: =
            Visible: =isAgendaVisible && !isAgendaEdit
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =12

        CloseCalendarEditButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: =Set(isAgendaVisible, true)
            Rotation: =If(isAgendaEdit || !isAgendaVisible = true, "45", "0")
            Visible: =!isAgendaVisible
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =13

        Group20 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =13

            CalendarEventsGallery1_1 As gallery.CalendarEventsGallery:
                AccessibleLabel: ="Agenda-items voor geselecteerde dag"
                Height: =Parent.Height - Self.Y
                Items: =SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =127
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =530
                X: =576
                Y: =LblDateSelected1.Y + LblDateSelected1.Height
                ZIndex: =8

                Icon16 As icon.Edit:
                    Color: =RGBA(128, 128, 128, 1)
                    Height: =27
                    Icon: =Icon.OpenInNewWindow
                    OnSelect: |+
                        =Set(isAgendaEdit, true);
                        Set(currentCalendarEventEmails, "");
                        Set(currentCalendarEventEmails, CalendarEventsGallery1_1.Selected.RequiredAttendees);
                        Set(htmlContent, CalendarEventsGallery1_1.Selected.Body)
                        
                        
                    Width: =27
                    X: =458
                    Y: =60
                    ZIndex: =6

                Icon17 As icon.Trash:
                    Color: =RGBA(168, 0, 0, 1)
                    Height: =27
                    Icon: =Icon.Trash
                    OnSelect: |-
                        =
                            Office365Outlook.CalendarDeleteItemV2(_myCalendar.Name, ThisItem.Id);
                            RemoveIf(MyCalendarEvents, Id = ThisItem.Id);
                        
                        
                        
                        // Ensure the _userDomain is set; if not already set
                        If(IsBlank(_userDomain), 
                            UpdateContext({_showLoading: true}),
                            Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
                            Set(_dateSelected, Today()),
                            Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
                            Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
                            Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
                        );
                        
                        // Set the calendar visibility and show loading context
                        Set(_calendarVisible, false);
                        UpdateContext({_showLoading: true});
                        
                        // Set the calendar variable based on the chosen Agenda
                        
                        
                        // Calculate min and max dates for the calendar view
                        Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                        Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
                        
                        // Retrieve calendar events and store them in a collection
                        ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
                        
                        // Hide loading context and make the calendar visible
                        UpdateContext({_showLoading: false});
                        Set(_calendarVisible, true);
                    Width: =27
                    X: =498
                    Y: =60
                    ZIndex: =7

                Label12 As label:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =55
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    Size: =16
                    Text: =ThisItem.Subject
                    Width: =426
                    X: =6
                    Y: =16
                    ZIndex: =8

                Label12_1 As label:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(255, 255, 255, 1)
                    FontWeight: =FontWeight.Lighter
                    Height: =31
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    Text: =ThisItem.Location
                    Width: =426
                    X: =6
                    Y: =54
                    ZIndex: =9

                Rectangle6 As rectangle:
                    Fill: =RGBA(219, 219, 219, 1)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =537
                    Y: =126
                    ZIndex: =10

                Label12_2 As label:
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(255, 255, 255, 1)
                    FontWeight: =FontWeight.Lighter
                    Height: =35
                    OnSelect: =Select(Parent)
                    PaddingLeft: =0
                    Text: =Text(ThisItem.Start, DateTimeFormat.ShortTime) & " - " & Text(ThisItem.End, DateTimeFormat.ShortTime)
                    Width: =426
                    X: =6
                    Y: =74
                    ZIndex: =11

            LblDateSelected1_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =RectMeetingBkg1.Height
                Size: =26
                Text: |-
                    =//Upper(Left(Text(_dateSelected; "dddd"); 1)) & Lower(Mid(Text(_dateSelected; "dddd"); 2))
                    
                    
                    
                    
                    If(
                        Or(
                            Text(_dateSelected, "dddd") = "monday",
                            Text(_dateSelected, "dddd") = "tuesday",
                            Text(_dateSelected, "dddd") = "wednesday",
                            Text(_dateSelected, "dddd") = "thursday",
                            Text(_dateSelected, "dddd") = "friday",
                            Text(_dateSelected, "dddd") = "saturday",
                            Text(_dateSelected, "dddd") = "sunday"
                        ),
                        
                        Switch(
                            Text(_dateSelected, "dddd"),
                            "monday", "Maandag",
                            "tuesday", "Dinsdag",
                            "wednesday", "Woensdag",
                            "thursday", "Donderdag",
                            "friday", "Vrijdag",
                            "saturday", "Zaterdag",
                            "sunday", "Zondag"
                        ),
                        
                        Switch(
                            Text(_dateSelected, "dddd"),
                            "maandag", "Maandag",
                            "dinsdag", "Dinsdag",
                            "woensdag", "Woensdag",
                            "donderdag", "Donderdag",
                            "vrijdag", "Vrijdag",
                            "zaterdag", "Zaterdag",
                            "zondag", "Zondag"
                        )
                    )
                    
                    
                    //Concatenate(
                    //    Upper(Mid(dayName; 1; 1));
                    //    Lower(Mid(dayName; 2; Len(dayName) - 1))
                    //)
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =Parent.Width / 3 - 60
                Wrap: =false
                X: =576
                Y: =21
                ZIndex: =9

            LblDateSelected1_2 As label:
                Color: =RGBA(207, 207, 207, 1)
                FontWeight: =FontWeight.Lighter
                Height: =RectMeetingBkg1.Height
                Size: =13
                Text: |-
                    =
                    Text(_dateSelected, DateTimeFormat.ShortDate)
                Visible: |
                    =isAgendaVisible && !isAgendaEdit
                Width: =Parent.Width / 3 - 60
                Wrap: =false
                X: =576
                Y: =53
                ZIndex: =10

            Rectangle4 As rectangle:
                Fill: =RGBA(192, 5, 230, 1)
                Height: =400
                Visible: |
                    =!isAgendaEdit
                Width: =1
                X: =560
                Y: =61
                ZIndex: =11

        CloseCalendarCancelEditButton As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Add
            OnSelect: =Set(isAgendaEdit, false)
            Rotation: =45
            Visible: =isAgendaEdit
            Width: =36
            X: =1056
            Y: =21
            ZIndex: =14

        Label9 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =76
            Text: ="Er zijn geen meetings gepland op deze dag."
            Visible: |-
                =If(IsEmpty(
                SortByColumns(Filter(MyCalendarEvents, Text(Start, DateTimeFormat.ShortDate) = Text(_dateSelected, DateTimeFormat.ShortDate)), "Start")
                
                ) && isAgendaEdit = false, true,false)
            Width: =544
            X: =576
            Y: =251
            ZIndex: =20

        Group13_1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =27

            LblMonthSelected1_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =47
                Size: =26
                Text: =Text(_firstDayOfMonth, "mmmm yyyy")
                Visible: =_calendarVisible && !isAgendaEdit
                Width: =361
                Wrap: =false
                X: =15
                Y: =18
                ZIndex: =22

            iconPrevMonth1_1 As icon.ChevronLeft:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(192, 5, 230, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =36
                Icon: =Icon.ChevronLeft
                OnSelect: |-
                    =/*changes month view to previous month*/
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, -1, TimeUnit.Months));
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                    /*collects calendar events for all days in current month view. Updates _minDate to prevent duplicate data collection if user returns to this month view*/
                    If(_minDate > _firstDayOfMonth, Set(_minDate, _firstDayOfMonth); Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_lastDayOfMonth, DateTimeFormat.UTC)).value))
                PaddingBottom: =7
                PaddingLeft: =7
                PaddingRight: =7
                PaddingTop: =7
                TabIndex: =0
                Tooltip: ="Vorige maand weergeven"
                Visible: =_calendarVisible && !isAgendaEdit
                Width: =36
                X: =439
                Y: =22
                ZIndex: =23

            iconNextMonth1_1 As icon.ChevronRight:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(192, 5, 230, 1)
                Fill: =RGBA(0,0,0,0)
                Height: =36
                Icon: =Icon.ChevronRight
                OnSelect: |-
                    =/*changes month view to next month*/
                    Set(_firstDayOfMonth, DateAdd(_firstDayOfMonth, 1, TimeUnit.Months));
                    Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                    /*collects calendar events for all days in current month view. Updates _maxDate to prevent duplicate data collection if user returns to this month view*/
                    Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days));
                    If(_lastDayOfMonth > _maxDate, Set(_maxDate, _lastDayOfMonth); Collect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_firstDayOfMonth, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value))
                PaddingBottom: =7
                PaddingLeft: =7
                PaddingRight: =7
                PaddingTop: =7
                TabIndex: =0
                Tooltip: ="Volgende maand weergeven"
                Visible: =_calendarVisible && !isAgendaEdit
                Width: =36
                X: =487
                Y: =22
                ZIndex: =24

            WeekdayGallery1_1 As gallery.WeekdayGallery:
                AccessibleLabel: ="Dagen van de week"
                BorderStyle: =BorderStyle.None
                Height: =48
                Items: =Calendar.WeekdaysShort()
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =76
                Visible: =_calendarVisible && !isAgendaEdit
                Width: =531
                X: =15
                Y: =88
                ZIndex: =25

                Title2_1 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =WeekdayGallery1_1.TemplateHeight
                    OnSelect: =Select(Parent)
                    Size: =17 * WeekdayGallery1_1.TemplateWidth / 77
                    Text: =ThisItem.Value
                    Width: =WeekdayGallery1_1.TemplateWidth
                    Wrap: =false
                    X: =WeekdayGallery1_1.TemplateWidth / 2 - Self.Width / 2
                    Y: =WeekdayGallery1_1.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =1

            MonthDayGallery1_1 As gallery.MonthDayGallery:
                AccessibleLabel: ="Dagen van geselecteerde maand"
                Height: =386
                Items: =[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19, 20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]
                Layout: =Layout.Vertical
                ShowScrollbar: =false
                TemplatePadding: =0
                TemplateSize: =60
                Visible: =_calendarVisible && !isAgendaEdit
                Width: =531
                WrapCount: =7
                X: =15
                Y: =136
                ZIndex: =26

                Circle2_1 As circle:
                    Fill: =RGBA(192, 5, 230, 1)
                    Height: =Self.Width
                    OnSelect: =Select(Parent)
                    Visible: |-
                        =/*Visible if calendar events are found on this day*/               
                        CountRows(Filter(MyCalendarEvents, DateValue(Text(Start)) = DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))) > 0 && !Subcircle1_1.Visible && Title3_2.Visible
                    Width: =6.5
                    X: =MonthDayGallery1_1.TemplateWidth / 2 - Self.Width / 2
                    Y: =MonthDayGallery1_1.TemplateHeight * (0.75)
                    ZIndex: =1

                Subcircle1_1 As circle:
                    Fill: =RGBA(192, 5, 230, 1)
                    Height: =3 * Title3_2.Size
                    OnSelect: =Select(Parent)
                    Visible: =And(DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, Title3_2.Visible)
                    Width: =Self.Height
                    X: =MonthDayGallery1_1.TemplateWidth/2 - Self.Width/2
                    Y: =MonthDayGallery1_1.TemplateHeight / 2 - Self.Height / 2
                    ZIndex: =2

                Title3_2 As label:
                    Align: =Align.Center
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Color: |-
                        =If(
                            DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected,
                            RGBA(255, 255, 255, 1),
                            Weekday(DateAdd(_firstDayInView, ThisItem.Value)) = 1 Or Weekday(DateAdd(_firstDayInView, ThisItem.Value)) = 7,
                        RGBA(128, 128, 128, 1),
                            DateAdd(_firstDayInView, ThisItem.Value) = Today(),
                            RGBA(255, 255, 255, 1),
                            LblMonthSelected1_1.Color
                        )
                    Fill: |-
                        =/*Fill value changes if the gallery item day = today, or if it lies outside of the current month*/             
                        If(
                            /*Date selected is today*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today() && DateAdd(_firstDayInView, ThisItem.Value) = _dateSelected, RGBA(0,0,0,0),
                            /*Today when it is not selected*/
                            DateAdd(_firstDayInView, ThisItem.Value) = Today(), RGBA(2,2,2,0.2), 
                            /*The day is outside the range of the currently selected month*/
                            Abs(Self.Text - ThisItem.Value) > 10,RGBA(200, 200, 200, 0.1), RGBA(0, 0, 0, 0))
                    FocusedBorderColor: =Self.Color
                    FocusedBorderThickness: =2
                    Height: =MonthDayGallery1_1.TemplateHeight
                    OnSelect: =Set(_dateSelected, DateAdd(_firstDayInView, ThisItem.Value, TimeUnit.Days))
                    Size: =17 * MonthDayGallery1_1.TemplateWidth / 91
                    TabIndex: =0
                    Text: =Day(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days))
                    Visible: |-
                        =/*This item is in a row containing no days of the visible month. It is in the row after the row where the last day of the month occurs*/ 
                         !(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days) - Weekday(DateAdd(_firstDayInView,ThisItem.Value, TimeUnit.Days)) + 1 > _lastDayOfMonth)
                    Width: =MonthDayGallery1_1.TemplateWidth
                    Wrap: =false
                    ZIndex: =3

        Group23 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =47

            Label13 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =49
                PaddingLeft: =0
                Size: =26
                Text: ="Nieuwe meeting"
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =339
                X: =590
                Y: =18
                ZIndex: =27

            input_meeting_subject As text:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderStyle: =BorderStyle.None
                Color: =RGBA(255, 255, 255, 1)
                Default: =
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HintText: ="Onderwerp v/d meeting"
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(45, 45, 45, 1)
                PaddingLeft: =5
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(45, 45, 45, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =350
                X: =590
                Y: =73
                ZIndex: =28

            input_meeting_info As text:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderStyle: =BorderStyle.None
                Color: =RGBA(255, 255, 255, 1)
                Default: =
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HintText: ="Informatie over de meeting"
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(45, 45, 45, 1)
                PaddingLeft: =5
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(45, 45, 45, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =350
                X: =590
                Y: =123
                ZIndex: =30

            DatePicker1_1 As datepicker:
                BorderColor: =RGBA(255, 255, 255, 1)
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                Color: =RGBA(255, 255, 255, 1)
                DisabledBorderColor: =RGBA(0, 0, 0, 1)
                Fill: =RGBA(45, 45, 45, 1)
                Height: =43
                Size: =13
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =154
                X: =590
                Y: =177
                ZIndex: =32

            Button1_2 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                Fill: =RGBA(192, 5, 230, 1)
                FontWeight: =FontWeight.Normal
                Height: =42
                HoverFill: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                OnSelect: |
                    =If(
                        DatePicker1_1.SelectedDate + Time(Value(Endtime_hours.Selected.Value), Value(Endtime_minutes.Selected.Value), 0) < DatePicker1_1.SelectedDate + Time(Value(Starttime_hours.Selected.Value), Value(Starttime_minutes.Selected.Value), 0),
                        Notify("End time cannot be before start time."),
                        If(
                            CountRows(
                                Filter(
                                    Office365Outlook.GetEventsCalendarViewV2(
                                        _myCalendar.Name,
                                        Text(
                                            DateAdd(
                                                DatePicker1_1.SelectedDate + Time(Value(Starttime_hours.Selected.Value), Value(Starttime_minutes.Selected.Value), 0),
                                                TimeZoneOffset(),
                                                "Minutes"
                                            ),
                                            "yyyy-mm-ddTHH:mm:ssZ"
                                        ),
                                        Text(
                                            DateAdd(
                                                DatePicker1_1.SelectedDate + Time(Value(Endtime_hours.Selected.Value), Value(Endtime_minutes.Selected.Value), 0),
                                                TimeZoneOffset(),
                                                "Minutes"
                                            ),
                                            "yyyy-mm-ddTHH:mm:ssZ"
                                        )
                                    ).value,
                                    DateValue(Text(Start, "yyyy-mm-dd")) = DateValue(Text(DatePicker1_1.SelectedDate, "yyyy-mm-dd"))
                                )
                            ) > 0,
                            Notify("nein bruder"),
                            Office365Outlook.V4CalendarPostItem(
                                LookUp(
                                    Office365Outlook.CalendarGetTables().value,
                                    DisplayName = "Agenda"
                                ).Name,
                                input_meeting_subject.Text,
                                Text(
                                    DateAdd(
                                        DatePicker1_1.SelectedDate + Time(Value(Starttime_hours.Selected.Value), Value(Starttime_minutes.Selected.Value), 0),
                                        TimeZoneOffset(),
                                        "Minutes"
                                    ),
                                    "yyyy-mm-ddTHH:mm:ssZ"
                                ),
                                Text(
                                    DateAdd(
                                        DatePicker1_1.SelectedDate + Time(Value(Endtime_hours.Selected.Value), Value(Endtime_minutes.Selected.Value), 0),
                                        TimeZoneOffset(),
                                        "Minutes"
                                    ),
                                    "yyyy-mm-ddTHH:mm:ssZ"
                                ),
                                "UTC",
                                {
                                    requiredAttendees: Concat(attendeesEmails, Value & "; "),
                                    responseRequested: true,
                                    isAllDay: false,
                                    body: input_meeting_info.Text,
                                    showAs: "busy"
                                }
                            )
                        )
                    )
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Text: ="Opslaan"
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =502
                X: =590
                Y: =454
                ZIndex: =33

            Starttime_hours As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(192, 5, 230, 1)
                ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                Color: =RGBA(255, 255, 255, 1)
                Default: ="9"
                DisabledBorderColor: =RGBA(192, 5, 230, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HoverBorderColor: =RGBA(192, 5, 230, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(63, 63, 63, 0.8)
                Items: |
                    =Sequence(24, 0, 1)
                PressedFill: =RGBA(63, 63, 63, 0.5)
                SelectionFill: =RGBA(63, 63, 63, 0.8)
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =75
                X: =590
                Y: =244
                ZIndex: =34

            Starttime_minutes As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(192, 5, 230, 1)
                ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                Color: =RGBA(255, 255, 255, 1)
                Default: ="30"
                DisabledBorderColor: =RGBA(192, 5, 230, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HoverBorderColor: =RGBA(192, 5, 230, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(63, 63, 63, 0.8)
                Items: |
                    =Sequence(4, 00, 15)
                PressedFill: =RGBA(63, 63, 63, 0.5)
                SelectionFill: =RGBA(63, 63, 63, 0.8)
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =75
                X: =687
                Y: =245
                ZIndex: =35

            Attendees_option As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(192, 5, 230, 1)
                ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                Color: =RGBA(255, 255, 255, 1)
                Default: ="9"
                DisabledBorderColor: =RGBA(192, 5, 230, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                Height: =44
                HoverBorderColor: =RGBA(192, 5, 230, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(63, 63, 63, 0.8)
                Items: =Filter(studenten_tabel, !IsBlank(Email))
                PressedFill: =RGBA(63, 63, 63, 0.5)
                SelectionFill: =RGBA(63, 63, 63, 0.8)
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =217
                X: =590
                Y: =351
                ZIndex: =37

            CloseCalendarButton_1 As icon.Add:
                Color: =RGBA(192, 5, 230, 1)
                Height: =36
                Icon: =Icon.Add
                OnSelect: |+
                    =If(IsEmpty(Filter(attendeesEmails, Value = Attendees_option.SelectedText.Email)),
                    Collect(attendeesEmails, Attendees_option.SelectedText.Email),
                    Notify("Already an Email, error maken..."));
                    
                Rotation: =
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =25
                X: =820
                Y: =355
                ZIndex: =39

            "Gallery1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =109
                Items: =attendeesEmails
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =46
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =260
                X: =859
                Y: =327
                ZIndex: =40

                Subtitle3 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    FontWeight: =FontWeight.Lighter
                    Height: =25
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Value
                    Width: =217
                    X: =5
                    Y: =10
                    ZIndex: =3

                NextArrow1 As icon.ChevronRight:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Color: =RGBA(168, 0, 0, 1)
                    DisabledBorderColor: =RGBA(56, 56, 56, 1)
                    DisabledColor: =RGBA(119, 119, 119, 1)
                    Height: =22
                    Icon: =Icon.Cancel
                    OnSelect: |
                        =Remove(attendeesEmails, LookUp(attendeesEmails, Value = ThisItem.Value))
                    Tooltip: ="Details van item weergeven"
                    Width: =22
                    X: =222
                    Y: =10
                    ZIndex: =4

            Label20 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =36
                Text: |-
                    =":"
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =30
                X: =668
                Y: =248
                ZIndex: =41

            Endtime_hours As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(192, 5, 230, 1)
                ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                Color: =RGBA(255, 255, 255, 1)
                Default: ="9"
                DisabledBorderColor: =RGBA(192, 5, 230, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HoverBorderColor: =RGBA(192, 5, 230, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(63, 63, 63, 0.8)
                Items: |
                    =Sequence(24, 0, 1)
                PressedFill: =RGBA(63, 63, 63, 0.5)
                SelectionFill: =RGBA(63, 63, 63, 0.8)
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =75
                X: =845
                Y: =245
                ZIndex: =42

            Endtime_minutes As dropdown:
                BorderStyle: =BorderStyle.None
                ChevronBackground: =RGBA(192, 5, 230, 1)
                ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                Color: =RGBA(255, 255, 255, 1)
                Default: ="30"
                DisabledBorderColor: =RGBA(192, 5, 230, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                HoverBorderColor: =RGBA(192, 5, 230, 1)
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(63, 63, 63, 0.8)
                Items: |
                    =Sequence(4, 00, 15)
                PressedFill: =RGBA(63, 63, 63, 0.5)
                SelectionFill: =RGBA(63, 63, 63, 0.8)
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =75
                X: =942
                Y: =245
                ZIndex: =43

            Label20_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =36
                Text: |-
                    =":"
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =29
                X: =923
                Y: =247
                ZIndex: =44

            Icon18 As icon.ArrowRight:
                Color: =RGBA(192, 5, 230, 1)
                DisplayMode: =DisplayMode.View
                Height: =25
                Icon: =Icon.ArrowRight
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =25
                X: =795
                Y: =254
                ZIndex: =45

            Label24 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =33
                PaddingLeft: =0
                Text: ="Deelnemers toevoegen"
                Visible: =!isAgendaVisible && !isAgendaEdit
                Width: =255
                X: =590
                Y: =318
                ZIndex: =46

        Group29 As group:
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =52

            Label8 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Bold
                Height: =45
                PaddingLeft: =0
                Size: =26
                Text: =CalendarEventsGallery1_1.Selected.Subject
                Visible: =isAgendaEdit
                Width: =884
                X: =22
                Y: =16
                ZIndex: =15

            Label8_1 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Upper(Left(Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.LongDate), 1)) &
                    Mid(Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.LongDate), 2)
                Visible: =isAgendaEdit
                Width: =486
                X: =128
                Y: =70
                ZIndex: =16

            Label8_2 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Semibold
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |-
                    ="Uitgenodigd:"
                Visible: =isAgendaEdit
                Width: =486
                X: =22
                Y: =170
                ZIndex: =17

            Label8_3 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =276
                Overflow: =Overflow.Scroll
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Concat(
                        Split(currentCalendarEventEmails, ";"),
                        Value & Char(10)
                    )
                VerticalAlign: =VerticalAlign.Top
                Visible: =isAgendaEdit
                Width: =508
                X: =22
                Y: =220
                ZIndex: =18

            Label8_4 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |
                    =Text(CalendarEventsGallery1_1.Selected.Start, DateTimeFormat.ShortTime) & " - " & Text(CalendarEventsGallery1_1.Selected.End, DateTimeFormat.ShortTime)
                Visible: =isAgendaEdit
                Width: =486
                X: =128
                Y: =120
                ZIndex: =19

            Rectangle11 As rectangle:
                Fill: =RGBA(192, 5, 230, 1)
                Height: =2
                Visible: =isAgendaEdit
                Width: =550
                X: =22
                Y: =62
                ZIndex: =47

            Label8_5 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |-
                    ="Datum:"
                Visible: =isAgendaEdit
                Width: =100
                X: =22
                Y: =70
                ZIndex: =48

            Label8_6 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =43
                PaddingLeft: =0
                Size: =16
                Text: |-
                    ="Tijd:"
                Visible: =isAgendaEdit
                Width: =100
                X: =22
                Y: =120
                ZIndex: =49

            Rectangle11_1 As rectangle:
                Fill: =RGBA(192, 5, 230, 1)
                Height: =2
                Visible: =isAgendaEdit
                Width: =200
                X: =22
                Y: =210
                ZIndex: =50

            Icon17_1 As icon.Trash:
                Color: =RGBA(168, 0, 0, 1)
                Height: =27
                Icon: =Icon.Trash
                OnSelect: |-
                    =
                        Office365Outlook.CalendarDeleteItemV2(_myCalendar.Name, CalendarEventsGallery1_1.Selected.Id);
                        RemoveIf(MyCalendarEvents, Id = CalendarEventsGallery1_1.Selected.Id);
                        Set(isAgendaEdit, false);
                    
                    
                    
                    // Ensure the _userDomain is set; if not already set
                    If(IsBlank(_userDomain), 
                        UpdateContext({_showLoading: true}),
                        Set(_userDomain, Right(User().Email, Len(User().Email) - Find("@", User().Email))),
                        Set(_dateSelected, Today()),
                        Set(_firstDayOfMonth, DateAdd(Today(), 1 - Day(Today()), TimeUnit.Days)),
                        Set(_firstDayInView, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days)),
                        Set(_lastDayOfMonth, DateAdd(DateAdd(_firstDayOfMonth, 1, TimeUnit.Months), -1, TimeUnit.Days))
                    );
                    
                    // Set the calendar visibility and show loading context
                    Set(_calendarVisible, false);
                    UpdateContext({_showLoading: true});
                    
                    // Set the calendar variable based on the chosen Agenda
                    
                    
                    // Calculate min and max dates for the calendar view
                    Set(_minDate, DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days));
                    Set(_maxDate, DateAdd(DateAdd(_firstDayOfMonth, -(Weekday(_firstDayOfMonth) - 2 + 1), TimeUnit.Days), 40, TimeUnit.Days));
                    
                    // Retrieve calendar events and store them in a collection
                    ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
                    
                    // Hide loading context and make the calendar visible
                    UpdateContext({_showLoading: false});
                    Set(_calendarVisible, true);
                Visible: =isAgendaEdit
                Width: =27
                X: =1017
                Y: =25
                ZIndex: =51

    Group25 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =19

        Rectangle7 As rectangle:
            Fill: =RGBA(45, 45, 45, 0.6)
            Height: =768
            Visible: =popupNewMeeting
            Width: =1366
            ZIndex: =5

        popupNewMeetingContainer As groupContainer.manualLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =RGBA(60, 60, 60, 1)
            Height: =522
            RadiusBottomLeft: =15
            RadiusBottomRight: =15
            RadiusTopLeft: =15
            RadiusTopRight: =15
            Visible: =popupNewMeeting
            Width: =1120
            X: =123
            Y: =123
            ZIndex: =6

            Label24_2 As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =33
                PaddingLeft: =0
                Text: |-
                    ="Deelnemers:"
                Visible: =popupNewMeeting && !IsEmpty(attendeesEmails)
                Width: =328
                X: =633
                Y: =71
                ZIndex: =18

            Group26 As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =18

                Label13_1 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =49
                    PaddingLeft: =0
                    Size: =26
                    Text: ="Nieuwe meeting"
                    Visible: =popupNewMeeting
                    Width: =436
                    X: =40
                    Y: =22
                    ZIndex: =1

                input_meeting_subject_1 As text:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(255, 255, 255, 1)
                    Default: =
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HintText: ="Onderwerp v/d meeting"
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(45, 45, 45, 1)
                    PaddingLeft: =5
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(45, 45, 45, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Visible: =popupNewMeeting
                    Width: =539
                    X: =40
                    Y: =91
                    ZIndex: =2

                input_meeting_info_1 As text:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.None
                    Color: =RGBA(255, 255, 255, 1)
                    Default: =
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HintText: ="Informatie over de meeting"
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(45, 45, 45, 1)
                    PaddingLeft: =5
                    PressedColor: =RGBA(255, 255, 255, 1)
                    PressedFill: =RGBA(45, 45, 45, 1)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Visible: =popupNewMeeting
                    Width: =539
                    X: =40
                    Y: =155
                    ZIndex: =3

                DatePicker1_2 As datepicker:
                    BorderColor: =RGBA(255, 255, 255, 1)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Color: =RGBA(255, 255, 255, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    Height: =43
                    Size: =13
                    Visible: =popupNewMeeting
                    Width: =140
                    X: =40
                    Y: =215
                    ZIndex: =4

                Rectangle8 As rectangle:
                    BorderStyle: =BorderStyle.None
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(60, 60, 60, 1)
                    Height: =46
                    Width: =106
                    X: =141
                    Y: =213
                    ZIndex: =5

                Button1_3 As button:
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =0
                    Fill: =RGBA(192, 5, 230, 1)
                    FontWeight: =FontWeight.Normal
                    Height: =42
                    HoverFill: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    OnSelect: |-
                        =Set(meeting_subject_error, false);
                        
                        If(
                            DatePicker1_2.SelectedDate + Time(Value(Endtime_hours_1.Selected.Value), Value(Endtime_minutes_1.Selected.Value), 0) < DatePicker1_2.SelectedDate + Time(Value(Starttime_hours_1.Selected.Value), Value(Starttime_minutes_1.Selected.Value), 0),
                            Notify("Controleer de tijden."),
                            If(IsBlank(input_meeting_info_1.Text) || IsBlank(input_meeting_subject_1.Text),
                            Set(meeting_subject_error, true),
                            If(
                                CountRows(
                                    Filter(
                                        Office365Outlook.GetEventsCalendarViewV2(
                                            _myCalendar.Name,
                                            Text(
                                                DateAdd(
                                                    DatePicker1_2.SelectedDate + Time(Value(Starttime_hours_1.Selected.Value), Value(Starttime_minutes_1.Selected.Value), 0),
                                                    TimeZoneOffset(),
                                                    "Minutes"
                                                ),
                                                "yyyy-mm-ddTHH:mm:ssZ"
                                            ),
                                            Text(
                                                DateAdd(
                                                    DatePicker1_2.SelectedDate + Time(Value(Endtime_hours_1.Selected.Value), Value(Endtime_minutes_1.Selected.Value), 0),
                                                    TimeZoneOffset(),
                                                    "Minutes"
                                                ),
                                                "yyyy-mm-ddTHH:mm:ssZ"
                                            )
                                        ).value,
                                        DateValue(Text(Start, "yyyy-mm-dd")) = DateValue(Text(DatePicker1_2.SelectedDate, "yyyy-mm-dd"))
                                    )
                                ) > 0,
                                Notify("Dubbele meeting"),
                                Office365Outlook.V4CalendarPostItem(
                                    LookUp(
                                        Office365Outlook.CalendarGetTables().value,
                                        DisplayName = "Agenda"
                                    ).Name,
                                    input_meeting_subject_1.Text,
                                    Text(
                                        DateAdd(
                                            DatePicker1_2.SelectedDate + Time(Value(Starttime_hours_1.Selected.Value), Value(Starttime_minutes_1.Selected.Value), 0),
                                            TimeZoneOffset(),
                                            "Minutes"
                                        ),
                                        "yyyy-mm-ddTHH:mm:ssZ"
                                    ),
                                    Text(
                                        DateAdd(
                                            DatePicker1_2.SelectedDate + Time(Value(Endtime_hours_1.Selected.Value), Value(Endtime_minutes_1.Selected.Value), 0),
                                            TimeZoneOffset(),
                                            "Minutes"
                                        ),
                                        "yyyy-mm-ddTHH:mm:ssZ"
                                    ),
                                    "UTC",
                                    {
                                        requiredAttendees: Concat(attendeesEmails, Value & "; "),
                                        responseRequested: true,
                                        isAllDay: false,
                                        body: input_meeting_info_1.Text,
                                        showAs: "busy"
                                    }
                                );
                                Reset(input_meeting_info_1);
                                Reset(input_meeting_subject_1);
                                Clear(attendeesEmails);
                                Set(popupNewMeeting, false);
                                
                                //Nieuwe Collectie
                                ClearCollect(MyCalendarEvents, Office365Outlook.GetEventsCalendarViewV2(_myCalendar.Name, Text(_minDate, DateTimeFormat.UTC), Text(_maxDate, DateTimeFormat.UTC)).value);
                            )
                            )
                        )
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Opslaan"
                    Visible: =popupNewMeeting
                    Width: =539
                    X: =40
                    Y: =458
                    ZIndex: =6

                Starttime_hours_1 As dropdown:
                    BorderStyle: =BorderStyle.None
                    ChevronBackground: =RGBA(192, 5, 230, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    Color: =RGBA(255, 255, 255, 1)
                    Default: ="9"
                    DisabledBorderColor: =RGBA(192, 5, 230, 1)
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HoverBorderColor: =RGBA(192, 5, 230, 1)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(63, 63, 63, 0.8)
                    Items: |
                        =Sequence(24, 0, 1)
                    PressedFill: =RGBA(63, 63, 63, 0.5)
                    SelectionFill: =RGBA(63, 63, 63, 0.8)
                    Visible: =popupNewMeeting
                    Width: =75
                    X: =172
                    Y: =217
                    ZIndex: =7

                Starttime_minutes_1 As dropdown:
                    BorderStyle: =BorderStyle.None
                    ChevronBackground: =RGBA(192, 5, 230, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    Color: =RGBA(255, 255, 255, 1)
                    Default: ="30"
                    DisabledBorderColor: =RGBA(192, 5, 230, 1)
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HoverBorderColor: =RGBA(192, 5, 230, 1)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(63, 63, 63, 0.8)
                    Items: |
                        =Sequence(4, 0, 15)
                    PressedFill: =RGBA(63, 63, 63, 0.5)
                    SelectionFill: =RGBA(63, 63, 63, 0.8)
                    Visible: =popupNewMeeting
                    Width: =75
                    X: =272
                    Y: =218
                    ZIndex: =8

                Attendees_option_1 As dropdown:
                    BorderStyle: =BorderStyle.None
                    ChevronBackground: =RGBA(192, 5, 230, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    Color: =RGBA(255, 255, 255, 1)
                    Default: ="9"
                    DisabledBorderColor: =RGBA(192, 5, 230, 1)
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    Height: =44
                    HoverBorderColor: =RGBA(192, 5, 230, 1)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(63, 63, 63, 0.8)
                    Items: |+
                        =If(dropdownEmailsCollection = "students",
                        Filter(studenten_tabel, !IsBlank(Email)),
                        Filter(intakes, !IsBlank(Email))
                        )
                        
                    PressedFill: =RGBA(63, 63, 63, 0.5)
                    SelectionFill: =RGBA(63, 63, 63, 0.8)
                    Visible: =popupNewMeeting
                    Width: =280
                    X: =40
                    Y: =345
                    ZIndex: =9

                CloseCalendarButton_2 As icon.Add:
                    Color: =RGBA(192, 5, 230, 1)
                    Height: =36
                    Icon: =Icon.Add
                    OnSelect: |+
                        =If(IsEmpty(Filter(attendeesEmails, Value = Attendees_option_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1Bcr884_email')),
                        Collect(attendeesEmails, Attendees_option_1.SelectedText.'data-ADB4D7A662F548B49FAC2B986E348A1Bcr884_email'),
                        Notify("Already an Email, error maken..."));
                        
                    Rotation: =
                    Visible: =popupNewMeeting
                    Width: =32
                    X: =336
                    Y: =349
                    ZIndex: =10

                "Gallery1_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    DelayItemLoading: =true
                    Height: =396
                    Items: =attendeesEmails
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =37
                    Visible: =popupNewMeeting
                    Width: =441
                    X: =633
                    Y: =104
                    ZIndex: =11

                    Subtitle3_2 As label:
                        Color: =RGBA(255, 255, 255, 1)
                        FontWeight: =FontWeight.Lighter
                        Height: =23
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Text: =ThisItem.Value
                        Width: =389
                        Y: =7
                        ZIndex: =3

                    NextArrow1_1 As icon.ChevronRight:
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Color: =RGBA(168, 0, 0, 1)
                        DisabledBorderColor: =RGBA(56, 56, 56, 1)
                        DisabledColor: =RGBA(119, 119, 119, 1)
                        Height: =22
                        Icon: =Icon.Cancel
                        OnSelect: |
                            =Remove(attendeesEmails, LookUp(attendeesEmails, Value = ThisItem.Value))
                        Tooltip: ="Details van item weergeven"
                        Width: =22
                        X: =414
                        Y: =8
                        ZIndex: =4

                Label20_2 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =36
                    Text: |-
                        =":"
                    Visible: =popupNewMeeting
                    Width: =39
                    X: =254
                    Y: =219
                    ZIndex: =12

                Endtime_hours_1 As dropdown:
                    BorderStyle: =BorderStyle.None
                    ChevronBackground: =RGBA(192, 5, 230, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    Color: =RGBA(255, 255, 255, 1)
                    Default: ="9"
                    DisabledBorderColor: =RGBA(192, 5, 230, 1)
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HoverBorderColor: =RGBA(192, 5, 230, 1)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(63, 63, 63, 0.8)
                    Items: |
                        =Sequence(24, 0, 1)
                    PressedFill: =RGBA(63, 63, 63, 0.5)
                    SelectionFill: =RGBA(63, 63, 63, 0.8)
                    Visible: =popupNewMeeting
                    Width: =75
                    X: =397
                    Y: =219
                    ZIndex: =13

                Endtime_minutes_1 As dropdown:
                    BorderStyle: =BorderStyle.None
                    ChevronBackground: =RGBA(192, 5, 230, 1)
                    ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                    Color: =RGBA(255, 255, 255, 1)
                    Default: ="30"
                    DisabledBorderColor: =RGBA(192, 5, 230, 1)
                    DisabledColor: =RGBA(255, 255, 255, 1)
                    DisabledFill: =RGBA(45, 45, 45, 1)
                    Fill: =RGBA(45, 45, 45, 1)
                    HoverBorderColor: =RGBA(192, 5, 230, 1)
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(63, 63, 63, 0.8)
                    Items: |
                        =Sequence(4, 00, 15)
                    PressedFill: =RGBA(63, 63, 63, 0.5)
                    SelectionFill: =RGBA(63, 63, 63, 0.8)
                    Visible: =popupNewMeeting
                    Width: =75
                    X: =504
                    Y: =219
                    ZIndex: =14

                Label20_3 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =36
                    Text: |-
                        =":"
                    Visible: =popupNewMeeting
                    Width: =37
                    X: =481
                    Y: =221
                    ZIndex: =15

                Icon18_1 As icon.ArrowRight:
                    Color: =RGBA(192, 5, 230, 1)
                    DisplayMode: =DisplayMode.View
                    Height: =25
                    Icon: =Icon.ArrowRight
                    Visible: =popupNewMeeting
                    Width: =32
                    X: =354
                    Y: =225
                    ZIndex: =16

                Label24_1 As label:
                    Color: =RGBA(255, 255, 255, 1)
                    FontWeight: =FontWeight.Semibold
                    Height: =33
                    PaddingLeft: =0
                    Text: ="Deelnemers toevoegen"
                    Visible: =popupNewMeeting
                    Width: =328
                    X: =40
                    Y: =272
                    ZIndex: =17

            Button7 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(192, 5, 230, 1)
                Fill: =If(dropdownEmailsCollection = "intakes", RGBA(192, 5, 230, 1), RGBA(45,45,45,1))
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverFill: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                OnSelect: =Set(dropdownEmailsCollection, "intakes")
                PressedColor: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =13
                Text: ="Intake e-mails"
                Width: =200
                X: =40
                Y: =310
                ZIndex: =22

            Button7_1 As button:
                BorderStyle: =BorderStyle.None
                BorderThickness: =0
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(192, 5, 230, 1)
                Fill: =If(dropdownEmailsCollection = "students", RGBA(192, 5, 230, 1), RGBA(45,45,45,1))
                FontWeight: =FontWeight.Lighter
                Height: =22
                HoverFill: =ColorFade(RGBA(192, 5, 230, 1), -20%)
                OnSelect: =Set(dropdownEmailsCollection, "students")
                PressedColor: =RGBA(255, 255, 255, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =13
                Text: ="Studenten e-mails"
                Width: =200
                X: =240
                Y: =310
                ZIndex: =23

            Label19 As label:
                Color: =RGBA(184, 0, 0, 1)
                Height: =30
                PaddingLeft: =0
                Text: ="Voer een onderwerp in."
                Visible: =meeting_subject_error
                Width: =250
                X: =40
                Y: =61
                ZIndex: =24

            Label19_1 As label:
                Color: =RGBA(184, 0, 0, 1)
                Height: =30
                PaddingLeft: =0
                Text: ="Voer informatie in."
                Visible: =meeting_subject_error
                Width: =250
                X: =40
                Y: =125
                ZIndex: =25

        closePopupNewMeeting As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =36
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(popupNewMeeting, false);
                Reset(input_meeting_info_1);
                Reset(input_meeting_subject_1);
                Clear(attendeesEmails);
                Set(dropdownEmailsCollection, "intakes");
            Rotation: =If(isAgendaEdit || !isAgendaVisible = true, "45", "0")
            Visible: =popupNewMeeting
            Width: =36
            X: =1194
            Y: =150
            ZIndex: =7

