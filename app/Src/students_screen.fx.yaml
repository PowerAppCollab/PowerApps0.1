students_screen As screen:
    Fill: =RGBA(45, 45, 45, 1)
    OnVisible: |+
        =Refresh(studenten_tabel);
        Set(isLoading, false);
        Set(scoresToevoegen, false);
        Set(isPopupExcelFileScoresOpen, false);
        Set(isExcelFileError, false);
        
        
        
        
        
        

    Button1 As button:
        Align: =Align.Left
        BorderColor: =
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        Color: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(255, 255, 255, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =FontWeight.Normal
        HoverFill: =
        OnSelect: =Set(isPopupExcelFileScoresOpen, true); Set(isExcelFileError, false); Reset(AttachControl_2); Set(noExamNameError, false); Set(ErrorWhileUploading, false); Reset(TextInput3)
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        PressedColor: =RGBA(128, 128, 128, 1)
        PressedFill: =
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Size: =13
        Text: ="Score uploaden"
        X: =180
        Y: =119
        ZIndex: =1

    navigatie_component_3 As navigatie_component:
        nav_agendaScreen: =agenda_screen
        nav_cursussenScreen: =courses_screen_1
        nav_groepenScreen: =groups_screen
        nav_intakesScreen: =intakes_screen
        nav_presenterenScreen: =presentatie_screen
        nav_studentenScreen: =students_screen
        ZIndex: =2

    container_5 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =250
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        X: =180
        Y: =160
        ZIndex: =5

        "gallery_students As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =250
            Items: |
                =Filter(
                    studenten_tabel,
                    If(
                        varShowArchived,
                        Archived = "true",
                Archived <> "true"
                    ) &&
                    (
                        dropdown_courses.Selected.name = "All" || course = dropdown_courses.Selected.name
                    ) &&
                    (
                        IsBlank(SearchInput1.Text) || SearchInput1.Text in Voornaam
                    ))
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =90
            Width: =500
            ZIndex: =1

            gallery_students_backgroundButton As button:
                BorderStyle: =BorderStyle.None
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =If(ThisItem.IsSelected, RGBA(192, 5, 230, 0.1), RGBA(0,0,0,0))
                Height: =90
                HoverFill: =
                OnSelect: =Select(Parent)
                PressedFill: =
                Text: =""
                Width: =500
                ZIndex: =1

            gallery_students_titleText As label:
                Color: =RGBA(255, 255, 255, 1)
                Height: =Self.Size * 1.8
                OnSelect: =Select(Parent)
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =ThisItem.Voornaam & " " & ThisItem.Achternaam
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.TemplateWidth - 86
                X: =16
                Y: =(Parent.TemplateHeight - (Self.Size * 1.8 + gallery_students_emailText.Size * 1.8)) / 2
                ZIndex: =2

            gallery_students_emailText As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Height: =33
                OnSelect: =Select(Parent)
                PaddingLeft: =0
                Text: =ThisItem.Email
                Width: =470
                X: =16
                Y: =37
                ZIndex: =3

            gallery_students_clickableButton As button:
                BorderStyle: =BorderStyle.None
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0,0,0,0)
                Height: =90
                HoverFill: =
                OnSelect: =Select(Parent)
                PressedFill: =
                Text: =""
                Width: =500
                ZIndex: =4

        label_gallery_students_error As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =61
            Text: ="Geen studenten gevonden."
            Visible: |-
                =If(
                    IsEmpty(
                        Filter(
                            studenten_tabel,
                            StartsWith(
                                Voornaam,
                                SearchInput1.Text
                            )
                        )
                    ),
                    true,
                    false
                )
            Width: =500
            Y: =95
            ZIndex: =2

    container_6 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =600
        X: =726
        Y: =40
        ZIndex: =6

        label_scoreTitle As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Size: =16
            Text: ="Scores"
            Width: =600
            Y: =10
            ZIndex: =1

        "gallery_score As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =150
            Items: =Filter(scores, studentID = gallery_students.Selected.Email)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =40
            Visible: |
                =If(
                    IsEmpty(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email
                        )
                    ) ||     IsBlank(gallery_students.Selected.Email) && IsBlank(gallery_students.Selected.Voornaam),
                    false,
                    If(
                        scoresToevoegen,
                        false,
                        true
                    )
                )
            Width: =600
            Y: =50
            ZIndex: =2

            gallery_score_date As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                OnSelect: =Select(Parent)
                Text: |
                    =Text(ThisItem.datum, "dd-mm-yyyy")
                X: =95
                ZIndex: =3

            gallery_score_scores As label:
                Color: =RGBA(192, 5, 230, 1)
                OnSelect: =Select(Parent)
                Text: =ThisItem.score
                Width: =50
                X: =15
                ZIndex: =4

            Icon2 As icon.Send:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(255, 255, 255, 1)
                Height: =20
                Icon: =Icon.Send
                OnSelect: =Set(SendMailBoxOpen, true);
                Width: =20
                X: =521
                Y: =11
                ZIndex: =5

            Icon8 As icon.Trash:
                Color: =RGBA(255, 255, 255, 1)
                DisabledColor: =RGBA(255, 255, 255, 1)
                Height: =20
                Icon: =Icon.Trash
                OnSelect: =RemoveIf(scores, ID = gallery_score.Selected.ID);
                Width: =20
                X: =555
                Y: =11
                ZIndex: =6

            gallery_score_scores_2 As label:
                Color: =RGBA(255, 255, 255, 1)
                OnSelect: =Select(Parent)
                Text: =ThisItem.Examen
                Width: =240
                X: =61
                ZIndex: =7

            gallery_score_scores_9 As label:
                Color: =RGBA(166, 166, 166, 1)
                FontWeight: =FontWeight.Lighter
                OnSelect: =Select(Parent)
                Text: =ThisItem.groupName
                Width: =220
                X: =301
                ZIndex: =8

        label_scoreTitle_error As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =75
            Text: ="Er zijn geen scores beschikbaar."
            Visible: |-
                =If(
                    !IsEmpty(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email && groupName = dropdown_courses_2.SelectedText.Value
                        )
                    ),
                    false,
                    If(
                        scoresToevoegen,
                        false,
                        true
                    )
                )
            Width: =600
            Y: =63
            ZIndex: =3

        Icon3 As icon.Add:
            Color: =RGBA(192, 5, 230, 1)
            Height: =35
            Icon: =Icon.Add
            OnSelect: |-
                =Set(scoresToevoegen, !scoresToevoegen);
                Reset(input_naam_examen);
                Reset(input_score_examen);
            Rotation: =If(scoresToevoegen, 45, 0)
            Width: =35
            X: =548
            Y: =10
            ZIndex: =4

        Dropdown1_1 As dropdown:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =0
            ChevronBackground: =RGBA(192, 5, 230, 0.8)
            ChevronHoverBackground: =
            Color: =RGBA(255, 255, 255, 1)
            DisabledColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(45, 45, 45, 1)
            FontWeight: =FontWeight.Lighter
            Height: =35
            HoverColor: =RGBA(243, 243, 243, 1)
            HoverFill: =RGBA(60, 60, 60, 0.8)
            Items: |
                =
                    Filter(
                        groepens,
                        groupID in Filter(
                            groepsInhoud,
                            student_id = gallery_students.Selected.studentID
                        ).groep_id
                    )
            PressedColor: =RGBA(243, 243, 243, 1)
            PressedFill: =RGBA(45, 45, 45, 0.8)
            SelectionFill: =RGBA(45, 45, 45, 1)
            Visible: =scoresToevoegen
            X: =42
            Y: =99
            ZIndex: =8

        groep_score_toevoegen As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =8

            input_naam_examen As text:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(255, 255, 255, 1)
                Default: =""
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                Height: =33
                HintText: ="Naam examen"
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(45, 45, 45, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(45, 45, 45, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =scoresToevoegen
                Width: =225
                X: =42
                Y: =50
                ZIndex: =5

            input_score_examen As text:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(255, 255, 255, 1)
                Default: =""
                DisabledColor: =RGBA(255, 255, 255, 1)
                DisabledFill: =RGBA(45, 45, 45, 1)
                Fill: =RGBA(45, 45, 45, 1)
                Height: =33
                HintText: ="Cijfer"
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =RGBA(45, 45, 45, 1)
                PressedColor: =RGBA(255, 255, 255, 1)
                PressedFill: =RGBA(45, 45, 45, 1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Visible: =scoresToevoegen
                Width: =225
                X: =323
                Y: =50
                ZIndex: =6

            Button2 As button:
                BorderStyle: =BorderStyle.None
                Fill: =RGBA(192, 5, 230, 1)
                FontWeight: =FontWeight.Normal
                Height: =33
                HoverFill: =ColorFade(RGBA(192,5,230,100), -20%)
                OnSelect: |
                    =If(
                        !IsBlank(Dropdown1_1.Selected.groupID) && 
                        !IsBlank(Dropdown1_1.Selected.name) &&
                        !IsBlank(Dropdown1_1.Selected.course) &&
                        !IsBlank(gallery_students.Selected.Email) &&
                        !IsBlank(input_score_examen.Text) &&
                        !IsBlank(input_naam_examen.Text),
                        Patch(
                            scores,
                            Defaults(scores),
                            {
                                groupID: Dropdown1_1.Selected.groupID,
                                groupName: Dropdown1_1.Selected.name,
                                courseID: Dropdown1_1.Selected.course,
                                studentID: gallery_students.Selected.Email,
                                score: Value(input_score_examen.Text),
                                Examen: input_naam_examen.Text,
                                ID: GUID()
                            }
                        ),
                        Set(
                            scoresToevoegen,
                            false
                        ),
                        Refresh(scores),
                        Notify("Score added successfully", NotificationType.Success)
                    ,
                        Notify("Please fill in all the required fields.", NotificationType.Error)
                    )
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =13
                Text: ="Toevoegen"
                Visible: =scoresToevoegen
                Width: =506
                X: =42
                Y: =150
                ZIndex: =7

    container_7 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =300
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        X: =180
        Y: =425
        ZIndex: =7

        LineChart1 As lineChart:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =274
            ItemColorSet: =[RGBA(192, 5, 230, 1),RGBA(48,166,103, 1), RGBA(94,193,108,1), RGBA(246,199,144,1), RGBA(247,199,114,1), RGBA(247,180,91,1), RGBA(246,143,100,1), RGBA(212,96,104,1), RGBA(148, 110, 176, 1), RGBA(118, 154, 204, 1), RGBA(96, 197, 234, 1)]
            Items: |-
                =ForAll(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email && groupName = dropdown_courses_2.SelectedText.Value
                        ),
                        {
                            score: score,
                            Examen: Examen
                        }
                    )
            NumberOfSeries: =0
            PaddingRight: =0
            ShowValues: =
            Visible: |-
                =If(
                   IsEmpty(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email && groupName = dropdown_courses_2.SelectedText.Value
                        )
                    ),
                    false,
                    true
                )
            Width: =500
            XLabelAngle: =55
            Y: =26
            YAxisMax: =100
            YAxisMin: =0
            ZIndex: =5

        label_chart_error As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =75
            Text: ="Er is geen grafiek beschikbaar."
            Visible: |-
                =If(
                   !IsEmpty(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email && groupName = dropdown_courses_2.SelectedText.Value
                        )
                    ),
                    false,
                    true
                )
            Width: =500
            Y: =113
            ZIndex: =6

        dropdown_courses_2 As dropdown:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderStyle: =BorderStyle.None
            ChevronBackground: =RGBA(192, 5, 230, 1)
            ChevronFill: =RGBA(0, 0, 0, 1)
            ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
            Color: =RGBA(255, 255, 255, 1)
            Default: ="All"
            Fill: =RGBA(45, 45, 45, 1)
            Height: =30
            HoverFill: =RGBA(192, 5, 230, 1)
            Items: |
                =Filter(
                    groepens,
                    groupID in Filter(
                        groepsInhoud,
                        student_id = gallery_students.Selected.studentID
                    ).groep_id
                ).name
            PressedColor: =RGBA(0, 0, 0, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(192, 5, 230, 1)
            Visible: |-
                =If(
                    IsEmpty(
                        Filter(
                            scores,
                            studentID = gallery_students.Selected.Email
                        )
                    ) || IsEmpty(Filter(groepsInhoud, student_id = gallery_students.Selected.studentID)),
                    false,
                    true
                )
            Width: =325
            X: =88
            Y: =8
            ZIndex: =7

    container_8 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =300
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =600
        X: =725
        Y: =270
        ZIndex: =8

        label_studentInformation As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Size: =16
            Text: ="Student Informatie"
            Width: =600
            Y: =10
            ZIndex: =2

        label_studentInformation_error_notSelected As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =66
            Text: ="Geen student geselecteerd."
            Visible: |-
                =If(
                    IsBlank(gallery_students.Selected.Email) && IsBlank(gallery_students.Selected.Voornaam),
                    true,
                    false
                )
            Width: =558
            X: =21
            Y: =117
            ZIndex: =3

        label_studentInformation_error_deleted As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =66
            Text: ="Deze student is reeds worden verwijderd. Enkel de scores en de cursussen zijn nog zichtbaar."
            Visible: |-
                =If(
                    IsBlank(gallery_students.Selected.Email) && !IsBlank(gallery_students.Selected.Voornaam),
                    true,
                    false
                )
            Width: =558
            X: =21
            Y: =117
            ZIndex: =4

        Group1 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =15

            Label6_6 As label:
                Color: =RGBA(255, 255, 255, 1)
                PaddingLeft: =0
                Text: ="Telefoonnummer"
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =170
                X: =52
                Y: =101
                ZIndex: =5

            Label6_8 As label:
                Color: =RGBA(255, 255, 255, 1)
                PaddingLeft: =0
                Text: ="Email"
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =170
                X: =52
                Y: =141
                ZIndex: =6

            Label6_9 As label:
                Color: =RGBA(255, 255, 255, 1)
                PaddingLeft: =0
                Text: ="Werkzaam bij"
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =170
                X: =52
                Y: =181
                ZIndex: =7

            Label6_10 As label:
                Color: =RGBA(255, 255, 255, 1)
                PaddingLeft: =0
                Text: ="Cursus"
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email) || editStudentData,
                        false,
                        true
                    )
                Width: =170
                X: =52
                Y: =221
                ZIndex: =8

            Label6_11 As label:
                Color: =RGBA(255, 255, 255, 1)
                PaddingLeft: =0
                Text: ="Naam"
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =170
                X: =52
                Y: =61
                ZIndex: =9

            Label7_5 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Text: |
                    =If(
                        !editStudentData, 
                    gallery_students.Selected.Voornaam & " " & gallery_students.Selected.Achternaam,
                    " "
                    )
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =315
                X: =233
                Y: =61
                ZIndex: =10

            Label7_6 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Text: |
                    =If(
                        !editStudentData, 
                    gallery_students.Selected.Telefoonnummer,
                    " "
                    )
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =315
                X: =233
                Y: =101
                ZIndex: =11

            Label7_7 As label:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =DisplayMode.View
                FontWeight: =FontWeight.Lighter
                Text: |
                    =If(
                        !editStudentData, 
                    gallery_students.Selected.Email,
                    " "
                    )
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =315
                X: =233
                Y: =141
                ZIndex: =12

            Label7_8 As label:
                Color: =RGBA(255, 255, 255, 1)
                FontWeight: =FontWeight.Lighter
                Text: |
                    =If(
                        !editStudentData, 
                    gallery_students.Selected.'Werkzaam Bij',
                    " "
                    )
                Visible: |
                    =If(
                        IsBlank(gallery_students.Selected.Email),
                        false,
                        true
                    )
                Width: =315
                X: =233
                Y: =181
                ZIndex: =13

        TextInputName_1 As text:
            BorderColor: =RGBA(192, 5, 230, 1)
            BorderStyle: =BorderStyle.None
            BorderThickness: =1
            Color: =RGBA(255, 255, 255, 1)
            Default: |
                =Text(LookUp(studenten_tabel, studentID = gallery_students.Selected.studentID).Voornaam) & " " & Text(gallery_students.Selected.Achternaam)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =5
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            Visible: =editStudentData
            Width: =315
            X: =233
            Y: =61
            ZIndex: =19

        Group17_4 As group:
            Height: =5
            Width: =5
            X: =-512
            Y: =37
            ZIndex: =19

            Container5_4 As groupContainer.manualLayoutContainer:
                DropShadow: =DropShadow.None
                Fill: =RGBA(45, 45, 45, 1)
                Height: =If(editStudentData = true, 80, 40)
                RadiusBottomLeft: =10
                RadiusBottomRight: =10
                RadiusTopLeft: =10
                RadiusTopRight: =10
                Width: =43
                X: =548
                Y: =10
                ZIndex: =15

            Icon14_10 As icon.Edit:
                Color: =RGBA(192, 5, 230, 1)
                Height: =28
                Icon: =Icon.Edit
                OnSelect: |-
                    =If(editStudentData = true, Set(editStudentData, false), Set(editStudentData, true));
                    
                    Refresh(studenten_tabel)
                Visible: =!editStudentData
                Width: =34
                X: =553
                Y: =15
                ZIndex: =16

            Icon14_11 As icon.Edit:
                Color: =RGBA(184, 0, 0, 1)
                Height: =28
                Icon: =Icon.Cancel
                OnSelect: |-
                    =If(editStudentData = true, Set(editStudentData, false), Set(editStudentData, true));
                    
                    Reset(TextInputName_1);
                    Reset(TextInputEmail_1);
                    Reset(TextInputPhoneNumber_1);
                    Reset(TextInputWerkZaamBij);
                Visible: =editStudentData
                Width: =34
                X: =553
                Y: =15
                ZIndex: =17

            Icon14_12 As icon.Edit:
                Color: =RGBA(192, 5, 230, 1)
                Height: =28
                Icon: =Icon.Check
                OnSelect: |
                    =// Split the text input into first name and surname
                    Set(varSplitText, Split(TextInputName_1.Text, " "));
                    
                    // Assign the first part to FirstName
                    Set(FirstName, First(varSplitText).Value);
                    
                    // Assign the last part to SurName
                    Set(SurName, Last(varSplitText).Value);
                    
                    // Check if the selected studentID exists in the studenten_tabel collection
                    If(
                        IsBlank(
                            LookUp(
                                studenten_tabel,
                                studentID = gallery_students.Selected.studentID
                            )
                        ),
                        // If studentID doesn't exist, create a new record
                        Patch(
                            studenten_tabel,
                            Defaults(studenten_tabel),
                            {
                                Voornaam: FirstName,
                                Achternaam: SurName,
                                Email: TextInputEmail_1.Text,
                                Telefoonnummer: TextInputPhoneNumber_1.Text,
                                'Werkzaam Bij': TextInputWerkZaamBij.Text
                            }
                        ),
                        // If studentID exists, update the existing record
                        Patch(
                            studenten_tabel,
                            LookUp(
                                studenten_tabel,
                                studentID = gallery_students.Selected.studentID
                            ),
                            {
                                Voornaam: FirstName,
                                Achternaam: SurName,
                                Email: TextInputEmail_1.Text,
                                Telefoonnummer: TextInputPhoneNumber_1.Text,
                                'Werkzaam Bij': TextInputWerkZaamBij.Text
                            }
                        )
                    );
                    
                    // Toggle the editStudentData variable
                    If(
                        editStudentData,
                        Set(editStudentData, false),
                        Set(editStudentData, true)
                    );
                    
                    // Reset the input fields
                    Reset(TextInputName_1);
                    Reset(TextInputEmail_1);
                    Reset(TextInputPhoneNumber_1);
                    Reset(TextInputWerkZaamBij);
                Visible: =editStudentData
                Width: =34
                X: =553
                Y: =55
                ZIndex: =18

        TextInputEmail_1 As text:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            Default: =Text(LookUp(studenten_tabel, studentID = gallery_students.Selected.studentID).Email)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =5
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            Visible: =editStudentData
            Width: =315
            X: =233
            Y: =141
            ZIndex: =20

        TextInputPhoneNumber_1 As text:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            Default: =Text(LookUp(studenten_tabel, studentID = gallery_students.Selected.studentID).Telefoonnummer)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =5
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            Visible: =editStudentData
            Width: =315
            X: =233
            Y: =101
            ZIndex: =21

        TextInputWerkZaamBij As text:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            Default: |
                =Text(LookUp(studenten_tabel, studentID = gallery_students.Selected.studentID).'Werkzaam Bij')
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            HoverBorderColor: =RGBA(0, 0, 0, 0)
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =5
            PressedBorderColor: =
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            Visible: =editStudentData
            Width: =315
            X: =233
            Y: =181
            ZIndex: =22

        Label7_9 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =63
            Overflow: =Overflow.Scroll
            Text: |
                =Text(
                    Concat(
                        Filter(
                            groepsInhoud,
                student_id = gallery_students.Selected.studentID),
                        cursus,
                        "  |  "
                    )
                )
                
                
                //If(
                //    !editStudentData; 
                //" "
                //)
            Visible: |
                =If(
                    IsBlank(gallery_students.Selected.Email) || editStudentData,
                    false,
                    true
                )
            Width: =346
            X: =233
            Y: =221
            ZIndex: =23

        Rectangle13 As rectangle:
            Fill: =RGBA(192, 5, 230, 1)
            Height: =1
            Visible: =editStudentData
            Width: =315
            X: =238
            Y: =95
            ZIndex: =24

        Rectangle13_1 As rectangle:
            Fill: =RGBA(192, 5, 230, 1)
            Height: =1
            Visible: =editStudentData
            Width: =315
            X: =238
            Y: =135
            ZIndex: =25

        Rectangle13_2 As rectangle:
            Fill: =RGBA(192, 5, 230, 1)
            Height: =1
            Visible: =editStudentData
            Width: =315
            X: =238
            Y: =175
            ZIndex: =26

        Rectangle13_3 As rectangle:
            Fill: =RGBA(192, 5, 230, 1)
            Height: =1
            Visible: =editStudentData
            Width: =315
            X: =238
            Y: =215
            ZIndex: =27

    container_9 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =75
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        X: =180
        Y: =40
        ZIndex: =9

        SearchInput1 As text:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            Default: =""
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(45, 45, 45, 1)
            Fill: =RGBA(45, 45, 45, 1)
            HintText: ="Zoek student..."
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(45, 45, 45, 1)
            RadiusBottomLeft: =10
            RadiusBottomRight: =10
            RadiusTopLeft: =10
            RadiusTopRight: =10
            Width: =250
            X: =15
            Y: =17
            ZIndex: =1

        Icon1 As icon.Search:
            Color: =RGBA(192, 5, 230, 1)
            Height: =35
            Icon: =Icon.Search
            Width: =35
            X: =274
            Y: =19
            ZIndex: =2

        dropdown_courses As dropdown:
            BorderColor: =RGBA(255, 255, 255, 1)
            BorderStyle: =BorderStyle.None
            ChevronBackground: =RGBA(192, 5, 230, 1)
            ChevronFill: =RGBA(0, 0, 0, 1)
            ChevronHoverBackground: =ColorFade(RGBA(192, 5, 230, 1), -20%)
            Color: =RGBA(255, 255, 255, 1)
            Default: ="All"
            Fill: =RGBA(45, 45, 45, 1)
            HoverFill: =RGBA(192, 5, 230, 1)
            Items: =courses
            OnChange: |
                =ClearCollect(
                    selectedStudentIDs,
                    Filter(
                        groepsInhoud,
                        cursus = Self.SelectedText.Value
                    ).student_id
                )
            PressedColor: =RGBA(0, 0, 0, 1)
            PressedFill: =RGBA(255, 255, 255, 1)
            SelectionFill: =RGBA(192, 5, 230, 1)
            Width: =156
            X: =324
            Y: =17
            ZIndex: =3

    container_10 As groupContainer.manualLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(60, 60, 60, 1)
        Height: =125
        RadiusBottomLeft: =15
        RadiusBottomRight: =15
        RadiusTopLeft: =15
        RadiusTopRight: =15
        Width: =600
        X: =725
        Y: =600
        ZIndex: =10

        groep_verwijder As group:
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =8

            groep_verwijder_icon As image:
                Height: =60
                Image: =user_x_line
                OnSelect: =Set(varShowPopup, true);
                Visible: =!openPopupPDF
                Width: =60
                X: =270
                Y: =20
                ZIndex: =5

            groep_verwijder_text As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                OnSelect: =Set(varShowPopup, true);
                Size: =11
                Text: ="Verwijder"
                Visible: =!openPopupPDF
                Width: =138
                X: =231
                Y: =74
                ZIndex: =6

            groep_verwijder_knop As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: =Set(varShowPopup, true);
                PressedFill: =
                Text: =""
                Visible: =!openPopupPDF
                Width: =86
                X: =251
                Y: =20
                ZIndex: =7

        Rectangle2 As rectangle:
            Fill: =RGBA(45, 45, 45, 0.6)
            Height: =125
            Visible: |
                =If(
                    !IsBlank(gallery_students.Selected.Email),
                    false,
                    true
                )
            Width: =600
            ZIndex: =12

        Group3 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =12

            intake_icon_4 As image:
                Height: =60
                Image: =presentation_2_line
                Visible: =!openPopupPDF
                Width: =60
                X: =79
                Y: =25
                ZIndex: =3

            label_intake_4 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Size: =11
                Text: ="Presenteer"
                Visible: =!openPopupPDF
                Width: =138
                X: =40
                Y: =79
                ZIndex: =4

            presenteerNav_knop As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: |-
                    =Set(currPresStudent, gallery_students.Selected);
                    Navigate(presentatie_screen);
                PressedFill: =
                Text: =""
                Visible: =!openPopupPDF
                Width: =86
                X: =66
                Y: =20
                ZIndex: =11

        Group2 As group:
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =12

            intake_icon_5 As image:
                Height: =60
                Image: =file_line
                Visible: =!openPopupPDF
                Width: =60
                X: =449
                Y: =20
                ZIndex: =8

            label_intake_5 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Size: =11
                Text: ="PDF"
                Visible: =!openPopupPDF
                Width: =138
                X: =410
                Y: =74
                ZIndex: =9

            groep_verwijder_knop_3 As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: =Set(openPopupPDF, true);
                PressedFill: =
                Text: =""
                Visible: =!openPopupPDF
                Width: =86
                X: =436
                Y: =20
                ZIndex: =10

        PDF_group_cert As group:
            Height: =5
            Width: =5
            X: =-409
            Y: =6
            ZIndex: =16

            intake_icon_7 As image:
                Height: =60
                Image: =file_line
                Visible: =openPopupPDF
                Width: =60
                X: =79
                Y: =20
                ZIndex: =13

            label_intake_7 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Size: =11
                Text: ="PDF Certificaat"
                Visible: =openPopupPDF
                Width: =138
                X: =40
                Y: =74
                ZIndex: =14

            groep_verwijder_knop_4 As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: |-
                    =Set(
                        TempStudentIDPDF,
                        gallery_students.Selected.Email
                    );
                    Navigate(PDFTEMPLATE_ENDSCORE)
                PressedFill: =
                Text: =""
                Visible: =openPopupPDF
                Width: =86
                X: =66
                Y: =20
                ZIndex: =15

        PDF_group_scores As group:
            Height: =5
            Width: =5
            X: =20
            Y: =6
            ZIndex: =19

            intake_icon_8 As image:
                Height: =60
                Image: =file_line
                Visible: =openPopupPDF
                Width: =60
                X: =270
                Y: =20
                ZIndex: =16

            label_intake_8 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Size: =11
                Text: ="PDF scores"
                Visible: =openPopupPDF
                Width: =138
                X: =231
                Y: =74
                ZIndex: =17

            groep_verwijder_knop_5 As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: |-
                    =Set(
                        TempStudentIDPDF,
                        gallery_students.Selected.Email
                    );
                    Navigate(PDFTEMPLATE_SCORES)
                PressedFill: =
                Text: =""
                Visible: =openPopupPDF
                Width: =86
                X: =257
                Y: =20
                ZIndex: =18

        Icon15 As icon.Cancel:
            Color: =RGBA(192, 5, 230, 1)
            Height: =25
            Icon: =Icon.Cancel
            OnSelect: =Set(openPopupPDF, false)
            Visible: =openPopupPDF
            Width: =25
            X: =562
            Y: =15
            ZIndex: =22

        PDF_group_participation As group:
            Height: =5
            Width: =5
            X: =40
            Y: =6
            ZIndex: =22

            intake_icon_9 As image:
                Height: =60
                Image: =file_line
                Visible: =openPopupPDF
                Width: =60
                X: =449
                Y: =20
                ZIndex: =19

            label_intake_9 As label:
                Align: =Align.Center
                Color: =RGBA(255, 255, 255, 1)
                Size: =11
                Text: ="PDF deelname"
                Visible: =openPopupPDF
                Width: =138
                X: =410
                Y: =74
                ZIndex: =20

            groep_verwijder_knop_6 As button:
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 0)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =94
                HoverFill: =
                OnSelect: |-
                    =Set(
                        TempStudentIDPDF,
                        gallery_students.Selected.Email
                    );
                    Navigate(PDFTEMPLATE_PARTICIPATION)
                PressedFill: =
                Text: =""
                Visible: =openPopupPDF
                Width: =86
                X: =436
                Y: =20
                ZIndex: =21

    Group16 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =28

        popup_background As rectangle:
            Fill: =RGBA(45, 45, 45, 0.8)
            Height: =768
            Visible: =varShowPopup
            Width: =1366
            ZIndex: =11

        popup_box As button:
            AutoDisableOnSelect: =false
            BorderStyle: =BorderStyle.None
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(60, 60, 60, 1)
            Height: =260
            Text: =""
            Visible: =varShowPopup
            Width: =663
            X: =352
            Y: =254
            ZIndex: =12

        popup_text As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =111
            Text: |-
                ="U staat op het punt om Jacks te verwijderen of te archiveren. Dit is niet omkeerbaar. 
                
                Weet u het zeker?"
            Visible: =varShowPopup
            Width: =454
            X: =456
            Y: =318
            ZIndex: =13

        popup_header As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =54
            Size: =18
            Text: ="Verwijder Student"
            Visible: =varShowPopup
            Width: =505
            X: =430
            Y: =266
            ZIndex: =14

        knop_verwijder As button:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(184, 0, 0, 1)
            FontWeight: =FontWeight.Normal
            HoverFill: =RGBA(184, 0, 0, 0.8)
            OnSelect: |-
                =Set(intakeFormIDTemp, "");
                Set(intakeIDTemp, "");
                
                Set(intakeIDTemp, gallery_students.Selected.intakeID);
                Set(intakeFormIDTemp, LookUp(intakes, intakeID = intakeIDTemp).intakeFormID);
                
                RemoveIf(studenten_tabel, studentID = gallery_students.Selected.studentID);
                
                RemoveIf(intakeForms, intakeFormID = intakeFormIDTemp);
                
                RemoveIf(intakes, intakeID = intakeIDTemp);
                
                RemoveIf(intakeNotes, intakeFormID = intakeFormIDTemp);
                
                RemoveIf(intakeTestScores, intakeFormID = intakeFormIDTemp);
                
                RemoveIf(intakeExtraVragen, intakeFormID = intakeFormIDTemp);
                
                
                Set(varShowPopup, false);
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Verwijder"
            Visible: =varShowPopup
            X: =397
            Y: =455
            ZIndex: =15

        knop_annuleer As button:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Normal
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 0.8)
            OnSelect: =Set(varShowPopup, false);
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Annuleer"
            Visible: =varShowPopup
            X: =810
            Y: =455
            ZIndex: =16

        knop_archiveer As button:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(50, 86, 160, 1)
            FontWeight: =FontWeight.Normal
            HoverFill: =RGBA(39, 67, 125, 1)
            OnSelect: |+
                =Set(intakeFormIDTemp, "");
                Set(intakeIDTemp, "");
                
                Set(intakeIDTemp, gallery_students.Selected.intakeID);
                Set(intakeFormIDTemp, LookUp(intakes, intakeID = intakeIDTemp).intakeFormID);
                
                Patch(studenten_tabel, gallery_students.Selected, {Voornaam: gallery_students.Selected.studentID, Achternaam: "", Email: "", Telefoonnummer: "", groupID: "", course: "", Archived: "true"});
                
                RemoveIf(intakeForms, intakeFormID = intakeFormIDTemp);
                
                RemoveIf(intakes, intakeID = intakeIDTemp);
                
                RemoveIf(intakeNotes, intakeFormID = intakeFormIDTemp);
                
                RemoveIf(intakeTestScores, intakeFormID = intakeFormIDTemp);
                
                Set(varShowPopup, false);
                
                
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Archiveer"
            Visible: =varShowPopup
            X: =603
            Y: =455
            ZIndex: =23

    groep_popup_sendscore As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =30

        popup_background_2 As rectangle:
            Fill: =RGBA(45, 45, 45, 0.8)
            Height: =768
            Visible: =SendMailBoxOpen
            Width: =1366
            ZIndex: =17

        popup_box_2 As button:
            AutoDisableOnSelect: =false
            BorderStyle: =BorderStyle.None
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(60, 60, 60, 1)
            Height: =260
            Text: =""
            Visible: =SendMailBoxOpen
            Width: =505
            X: =430
            Y: =254
            ZIndex: =18

        popup_text_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =87
            Text: |-
                ="U staat op het punt om " & gallery_students.Selected.Voornaam & " een mail te sturen met zijn of haar score. Wilt u hiermee doorgaan?
                
                Weet u het zeker?"
            Visible: =SendMailBoxOpen
            Width: =454
            X: =456
            Y: =332
            ZIndex: =19

        popup_header_2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =54
            Size: =18
            Text: ="Verstuur Score"
            Visible: =SendMailBoxOpen
            Width: =505
            X: =430
            Y: =266
            ZIndex: =20

        knop_verwijder_2 As button:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(192, 5, 230, 1)
            FontWeight: =FontWeight.Normal
            HoverFill: =RGBA(192, 5, 230, 0.8)
            OnSelect: |-
                =MailScore.Run(gallery_students.Selected.Voornaam, gallery_score.Selected.score, gallery_students.Selected.Email);
                Set(SendMailBoxOpen, false);
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Verstuur"
            Visible: =SendMailBoxOpen
            X: =726
            Y: =455
            ZIndex: =21

        knop_annuleer_2 As button:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Normal
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 0.8)
            OnSelect: =Set(SendMailBoxOpen, false);
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Annuleer"
            Visible: =SendMailBoxOpen
            X: =486
            Y: =455
            ZIndex: =22

    groep_popup_sendpdf As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =34

        popup_background_3 As rectangle:
            Fill: =RGBA(45, 45, 45, 0.8)
            Height: =768
            Visible: =PDFisMade
            Width: =1366
            ZIndex: =24

        popup_box_3 As button:
            AutoDisableOnSelect: =false
            BorderStyle: =BorderStyle.None
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(60, 60, 60, 1)
            Height: =260
            Text: =""
            Visible: =PDFisMade
            Width: =505
            X: =430
            Y: =254
            ZIndex: =25

        popup_text_3 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =87
            Text: ="U staat op het punt om het gegenereerde PDF bestand te versturen naar " & gallery_students.Selected.Voornaam & " . Wilt u hiermee doorgaan?"
            Visible: =PDFisMade
            Width: =454
            X: =456
            Y: =332
            ZIndex: =26

        popup_header_3 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =54
            Size: =18
            Text: ="PDF versturen"
            Visible: =PDFisMade
            Width: =505
            X: =430
            Y: =266
            ZIndex: =27

        knop_sendPDF As button:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(192, 5, 230, 1)
            FontWeight: =FontWeight.Normal
            HoverFill: =RGBA(192, 5, 230, 0.8)
            OnSelect: |+
                =Office365Outlook.SendEmailV2(TempStudentIDPDF, "Onderwerp", "Body of the mail", {Attachments:Table({Name: "Rapport" & LookUp(studenten_tabel, Email = TempStudentIDPDF).Voornaam & ".pdf", ContentBytes:PDF_Scores })});
                
                Set(PDFisMade, false);
                Set(PDF_Scores, "");
                Set(openPopupPDF, false);
                
                
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Verstuur"
            Visible: =PDFisMade
            X: =726
            Y: =455
            ZIndex: =28

        knop_annuleer_3 As button:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Normal
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 0.8)
            OnSelect: |+
                =Set(PDFisMade, false);
                Set(PDF_Scores, "");
                Set(openPopupPDF, false);
                
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Annuleer"
            Visible: =PDFisMade
            X: =486
            Y: =455
            ZIndex: =29

    Rectangle9 As rectangle:
        Fill: =RGBA(45, 45, 45, 0.8)
        Height: =768
        Visible: =isPopupExcelFileScoresOpen
        Width: =1366
        ZIndex: =36

    Rectangle10 As rectangle:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        DisabledFill: =
        Fill: =RGBA(60, 60, 60, 1)
        Height: =455
        HoverFill: =
        PressedFill: =
        Visible: =isPopupExcelFileScoresOpen
        Width: =806
        X: =280
        Y: =157
        ZIndex: =37

    Icon19 As icon.Cancel:
        Color: =RGBA(192, 5, 230, 1)
        Height: =35
        Icon: =Icon.Cancel
        OnSelect: |-
            =Set(isPopupExcelFileScoresOpen, false); Set(isExcelFileError, false); 
            Set(noExamNameError, false);
            Set(ErrorWhileUploading, false);
            
            Refresh(scores);
            
            Clear(failedEmailsCollection);
            Set(testArray, "");
            Clear(splitEmails);
        Visible: =isPopupExcelFileScoresOpen
        Width: =35
        X: =1030
        Y: =175
        ZIndex: =38

    Label6 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =56
        Size: =18
        Text: =If(ErrorWhileUploading = true, "Scores uploaden | Error","Scores uploaden")
        Visible: =isPopupExcelFileScoresOpen
        Width: =384
        X: =491
        Y: =165
        ZIndex: =40

    removeArchivedPopUp As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =40

        popup_background_17 As rectangle:
            Fill: =RGBA(45, 45, 45, 0.8)
            Height: =768
            Visible: =varShowDeleteArchivedPopUp
            Width: =1366
            ZIndex: =30

        popup_box_17 As button:
            AutoDisableOnSelect: =false
            BorderStyle: =BorderStyle.None
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(60, 60, 60, 1)
            Height: =235
            Text: =""
            Visible: =varShowDeleteArchivedPopUp
            Width: =505
            X: =431
            Y: =255
            ZIndex: =31

        popup_header_15 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Semibold
            Height: =54
            Size: =18
            Text: ="weet je het zeker?"
            Visible: =varShowDeleteArchivedPopUp
            Width: =505
            X: =430
            Y: =261
            ZIndex: =32

        knop_toevoegen_11 As button:
            BorderStyle: =BorderStyle.None
            BorderThickness: =0
            Fill: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Normal
            HoverFill: =RGBA(184, 0, 0, 1)
            OnSelect: |
                =Remove(
                    studenten_tabel, // The name of the entity
                    gallery_students.Selected // The record you want to delete
                );
                
                Set(varShowDeleteArchivedPopUp, false); // Hides the popup after the operations
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="verwijderen"
            Visible: =varShowDeleteArchivedPopUp
            X: =487
            Y: =415
            ZIndex: =33

        knop_annuleer_16 As button:
            BorderStyle: =BorderStyle.None
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Normal
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(255, 255, 255, 0.8)
            OnSelect: =Set(varShowDeleteArchivedPopUp, false)
            RadiusBottomLeft: =6
            RadiusBottomRight: =6
            RadiusTopLeft: =6
            RadiusTopRight: =6
            Size: =13
            Text: ="Annuleer"
            Visible: =varShowDeleteArchivedPopUp
            X: =727
            Y: =415
            ZIndex: =34

        Label9_5 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =57
            Text: ="weet je het zeker om deze colom te verwijderen?"
            Visible: =varShowDeleteArchivedPopUp
            Width: =285
            X: =559
            Y: =324
            ZIndex: =35

    Group6 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =42

        Toggle1 As toggleSwitch:
            BorderStyle: =BorderStyle.None
            FalseFill: =RGBA(60, 60, 60, 1)
            FalseText: =
            Height: =25
            HoverBorderColor: =
            OnChange: |-
                =Set(varShowArchived, !varShowArchived);
                Set(varShowActive, !varShowActive)
            TrueFill: =RGBA(192, 5, 230, 1)
            TrueText: =
            Width: =75
            X: =635
            Y: =127
            ZIndex: =3

        Label17 As label:
            Align: =Align.Right
            Color: =RGBA(255, 255, 255, 1)
            Height: =29
            Text: ="Toon gearchiveerde studenten"
            Width: =283
            X: =352
            Y: =123
            ZIndex: =4

    Label26 As label:
        Color: =RGBA(184, 0, 0, 1)
        Height: =29
        Size: =11
        Text: ="Geef de score een naam."
        Visible: =noExamNameError && isPopupExcelFileScoresOpen
        Width: =235
        X: =457
        Y: =368
        ZIndex: =45

    Label23_1 As label:
        Color: =RGBA(255, 255, 255, 1)
        FontWeight: =FontWeight.Lighter
        Text: |-
            ="Groep:"
        Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
        X: =322
        Y: =429
        ZIndex: =46

    Dropdown1 As dropdown:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        ChevronBackground: =RGBA(192, 5, 230, 0.8)
        ChevronHoverBackground: =
        Color: =RGBA(255, 255, 255, 1)
        DisabledColor: =RGBA(255, 255, 255, 1)
        Fill: =RGBA(45, 45, 45, 1)
        FontWeight: =FontWeight.Lighter
        Height: =35
        HoverColor: =RGBA(243, 243, 243, 1)
        HoverFill: =RGBA(60, 60, 60, 0.8)
        Items: =groepens.name
        PressedColor: =RGBA(243, 243, 243, 1)
        PressedFill: =RGBA(45, 45, 45, 0.8)
        SelectionFill: =RGBA(45, 45, 45, 1)
        Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
        X: =456
        Y: =431
        ZIndex: =47

    "Gallery2 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =177
        Items: =splitEmails
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =39
        Visible: =ErrorWhileUploading
        Width: =708
        X: =322
        Y: =350
        ZIndex: =48

        Title5 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =Self.Size * 1.8
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =13
            Text: =ThisItem.Value
            VerticalAlign: =VerticalAlign.Top
            Width: =Parent.TemplateWidth - 86
            X: =20
            Y: =9
            ZIndex: =1

    loadingOn_1 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =48

        background_loading_1 As rectangle:
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(45, 45, 45, 0.8)
            Height: =768
            Visible: =isLoading
            Width: =1366
            ZIndex: =50

        spinner_loading_1 As image:
            Height: =175
            Image: ='Double Ring@2x-1.5s-200px-200px'
            Visible: =isLoading
            Width: =175
            X: =595
            Y: =292
            ZIndex: =51

    Label27 As label:
        Align: =Align.Center
        Color: =RGBA(202, 202, 202, 1)
        Height: =123
        Overflow: =Overflow.Scroll
        Text: |-
            ="Er is iets mis gegaan tijdens het uploaden, deze emails kunnen niet gekoppeld worden aan studenten in deze app. Je zal deze nu handmatig moeten toevoegen.
            
            Let op: Als je het bestand nog een keer upload zullen alle scores dubbel geupload zijn."
        Visible: =ErrorWhileUploading
        Width: =706
        X: =337
        Y: =227
        ZIndex: =49

    Group8 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =50

        AttachControl_2 As attachments:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(0, 0, 0, 0)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DropTargetBackgroundColor: =RGBA(0, 0, 0, 0)
            DropTargetBorderColor: =RGBA(0, 0, 0, 0)
            DropTargetBorderStyle: =BorderStyle.None
            DropTargetTextColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            Height: =110
            HoverBorderColor: =RGBA(128, 128, 128, 1)
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            IsInDataCard: =true
            Items: =
            OnAddFile: |
                =Set(isLoading, true);
                Set(ErrorWhileUploading, false);
                
                If(IsBlank(TextInput3.Text),
                    Set(noExamNameError, true);
                    Set(isLoading, false);
                    Set(isExcelFileError, false);
                    Reset(Self),
                
                    Set(noExamNameError, false);
                    If(EndsWith(Last(Self.Attachments).Name, ".xlsx"),
                
                    //true
                    //Set(isPopupExcelFileScoresOpen; false);;
                
                
                
                    //automate
                    Set(failedEmails, uploadScoreFiles.Run(
                        {
                            contentBytes: Last(Self.Attachments).Value,
                            name: Last(Self.Attachments).Name
                        },
                        TextInput3.Text,
                        Dropdown1.SelectedText.Value,
                        LookUp(groepens, name = Dropdown1.SelectedText.Value).groupID)
                    );
                
                    ClearCollect(failedEmailsCollection, failedEmails);
                    Set(testArray, failedEmails.failedemails);
                    ClearCollect(splitEmails,Split(testArray, ";"));
                
                    ClearCollect(validEmails, Filter(splitEmails, !IsBlank(Value) && Value <> ""));
                
                    If(IsEmpty(validEmails),
                    Set(ErrorWhileUploading, false),
                    //TODO SUCCESF~UL
                    
                    Set(ErrorWhileUploading, true));
                
                    //reset vars
                    Reset(Self);
                    Set(isLoading, false);
                    Set(isExcelFileError, false),
                
                    //false
                    Reset(Self);
                    Set(isLoading, false);
                    Refresh(scores);
                    Set(isExcelFileError, true)
                    )
                )
            PaddingBottom: =5
            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
            PaddingRight: =5
            PaddingTop: =5
            PressedColor: =RGBA(237, 237, 237, 1)
            PressedFill: =RGBA(0, 0, 0, 0)
            Tooltip: =
            Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
            Width: =287
            X: =546
            Y: =502
            ZIndex: =39

        Label22 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Height: =123
            Overflow: =Overflow.Scroll
            Text: |-
                ="Het bestand moet aan de volgende criteria voldoen:
                - Het bestand moet een '.xlsx'-bestand zijn.
                - De gegevens staan in een tabel genaamd 'Tabel1'.
                - Er moet een 'Average score' kolom bestaan waar de behaalde scores in staan.
                - Er moet een 'Email' kolom bestaan waar de juiste email in staat van de student."
            Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
            Width: =721
            X: =323
            Y: =227
            ZIndex: =41

        Label23 As label:
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Lighter
            Text: |-
                ="Naam Examen:"
            Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
            X: =322
            Y: =389
            ZIndex: =42

        TextInput3 As text:
            BorderStyle: =BorderStyle.None
            BorderThickness: =0
            Clear: =true
            Color: =RGBA(255, 255, 255, 1)
            Default: =
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            HintText: ="'Examen 1'"
            HoverColor: =RGBA(255, 255, 255, 1)
            HoverFill: =RGBA(0, 0, 0, 0)
            PaddingLeft: =5
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =
            Visible: =isPopupExcelFileScoresOpen && !ErrorWhileUploading
            X: =456
            Y: =389
            ZIndex: =43

        Label25 As label:
            Align: =Align.Center
            Color: =RGBA(184, 0, 0, 1)
            Height: =74
            Text: ="Het bestad dient een '.xlsx'-bestand te zijn."
            Visible: =isExcelFileError && !ErrorWhileUploading
            Width: =406
            X: =480
            Y: =453
            ZIndex: =44

